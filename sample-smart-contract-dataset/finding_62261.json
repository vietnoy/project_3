{
    "id": 62261,
    "kind": "PDF",
    "auditfirm_id": 6,
    "impact": "MEDIUM",
    "finders_count": 3,
    "protocol_id": 3395,
    "title": "Using idle balance in computing isGranted doesn't account for freezed & blacklisted tokens",
    "content": "## Severity: Medium Risk\n\n## Context\nMinVotingPowerCondition.sol#L45\n\n## Description\nIn `MinVotingPowerCondition.isGranted`.\n\n```solidity\nfunction isGranted(address _where, address _who, bytes32 _permissionId, bytes calldata _data)\npublic\nview\noverride\nreturns (bool)\n{\n    (_where, _data, _permissionId);\n    uint256 _currentBalance = token.balanceOf(_who) + lockManager.getLockedBalance(_who);\n    uint256 _minProposerVotingPower = plugin.minProposerVotingPower();\n    return _currentBalance >= _minProposerVotingPower;\n}\n```\n\nIf an address holds tokens but can't spend them due to being frozen or blacklisted, then they are granted access (i.e., in this case, they can create a proposal). However, the intended behavior should be to not allow calling create proposal as tokens are not transferable.\n\n### Examples:\n- Token is USDT/USDC, address holds funds but is blacklisted; then they can still create a proposal.\n- Token is morpho-vault-v2 share, but holder is blacklisted by gates.\n\n## Recommendation\nDo not use `token.balanceOf(_who)`; rather, actually lock the tokens in `LockManager` by making a transfer.\n\n## Aragon\nFixed in PR 28.\n\n## Spearbit\nFix verified.",
    "summary": "\nThe bug report is about a medium risk bug in the MinVotingPowerCondition.sol file. The issue is in the `isGranted` function, which allows addresses with frozen or blacklisted tokens to still create proposals. This is not the intended behavior, as the function should not allow proposals from addresses with non-transferable tokens. The recommendation is to fix this by actually locking the tokens in the LockManager instead of just checking the balance. The bug has been fixed in PR 28 and verified by Spearbit.",
    "report_date": "2025-08-28T00:00:00.000Z",
    "contest_prize_txt": "",
    "contest_link": "https://github.com/spearbit/portfolio/blob/master/pdfs/Aragon-Spearbit-Security-Review-July-2025.pdf",
    "sponsor_name": null,
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://github.com/spearbit/portfolio/blob/master/pdfs/Aragon-Spearbit-Security-Review-July-2025.pdf",
    "github_link": "",
    "pdf_link": "https://solodit-bucket.s3.amazonaws.com/storage/reports/spearbit/Aragon-Spearbit-Security-Review-July-2025.pdf",
    "pdf_page_from": 14,
    "contest_id": "",
    "slug": "using-idle-balance-in-computing-isgranted-doesnt-account-for-freezed-blacklisted-tokens-spearbit-none-aragon-dao-gov-plugin-pdf",
    "firm_name": "Spearbit",
    "firm_logo_square": "spearbit_square.png",
    "protocol_name": "Aragon DAO Gov Plugin",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Om Parikh"
            }
        },
        {
            "wardens_warden": {
                "handle": "Emanuelle Ricci"
            }
        },
        {
            "wardens_warden": {
                "handle": "Patrick Drotleff"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Spearbit",
        "logo_square": "spearbit_square.png"
    },
    "protocols_protocol": {
        "name": "Aragon DAO Gov Plugin",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}