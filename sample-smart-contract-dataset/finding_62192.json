{
    "id": 62192,
    "kind": "MARKDOWN",
    "auditfirm_id": 30,
    "impact": "MEDIUM",
    "finders_count": 1,
    "protocol_id": 3390,
    "title": "[M-01] User Can Lose ETH in `bridgeRingToAbstract()`",
    "content": "\n## Severity\n\nMedium Risk\n\n## Description\n\nThe vulnerability arises in the `bridgeRingToAbstract()` function of the `ETHBridge` contract. The function begins by checking whether the provided `tokenIds` array is empty. If the length of the array is zero, the function immediately returns without performing any further operations. However, the function is marked payable, and no refund logic is implemented prior to returning. As a result, if a caller mistakenly sends a non-zero `msg.value` while providing an empty tokenIds array, the transaction will succeed, but the ETH sent will remain trapped within the contract. Since the contract does not expose any withdrawal mechanism for the owner or users, this ETH cannot be recovered and will remain permanently locked.\n\n## Location of Affected Code\n\nFile: [contracts/ETHBridge.sol#L69](https://github.com/onchain-heroes/och-bridge-contracts/blob/6b6bb6bcbf718649fe9ea3539414149f2a6d28aa/contracts/ETHBridge.sol#L69)\n\n```solidity\nfunction bridgeRingToAbstract(address recipient, uint256[] calldata tokenIds, bytes calldata options) external payable {\n    uint256 len = tokenIds.length;\n\n    // If `tokenIds.length == 0`, then return function\n    if (len == 0) {\n        return;\n    }\n    // code\n}\n```\n\n## Impact\n\nThis issue creates a condition where user funds can be silently lost without any observable indication of an error. A user intending to bridge NFTs could mistakenly send ETH alongside an empty tokenIds array. Because the transaction does not revert and the ETH remains in the contract, users may incur direct financial loss.\n\n## Recommendation\n\nTo prevent ETH from being trapped, the function should enforce a non-empty tokenIds array as a precondition. Instead of silently returning when the array length is zero, the function should revert with a clear error message, ensuring that no ETH is accepted in such cases.\n\n## Team Response\n\nFixed.\n\n",
    "summary": "\nThis bug report discusses a vulnerability found in the `bridgeRingToAbstract()` function of the `ETHBridge` contract. This function checks if the provided `tokenIds` array is empty and immediately returns if it is. However, the function is marked as payable and does not have any refund logic, which means that if someone accidentally sends ETH while providing an empty array, the ETH will be trapped in the contract and cannot be recovered. This can result in financial loss for users. The recommended solution is to make sure the array is not empty before proceeding and to revert with an error message if it is. The team has fixed this issue.",
    "report_date": "2025-08-27T00:00:00.000Z",
    "contest_prize_txt": "",
    "contest_link": "",
    "sponsor_name": null,
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://github.com/shieldify-security/audits-portfolio-md/blob/main/OnchainHeroes-GenesisBridge-Security-Review.md",
    "github_link": "",
    "pdf_link": "",
    "pdf_page_from": 0,
    "contest_id": "",
    "slug": "m-01-user-can-lose-eth-in-bridgeringtoabstract-shieldify-none-onchainheroes-genesisbridge-markdown",
    "firm_name": "Shieldify",
    "firm_logo_square": "Shieldify_square.png",
    "protocol_name": "Onchainheroes Genesisbridge",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Shieldify Security"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Shieldify",
        "logo_square": "Shieldify_square.png"
    },
    "protocols_protocol": {
        "name": "Onchainheroes Genesisbridge",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}