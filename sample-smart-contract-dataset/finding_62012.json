{
    "id": 62012,
    "kind": "MARKDOWN",
    "auditfirm_id": 37,
    "impact": "HIGH",
    "finders_count": 3,
    "protocol_id": 3363,
    "title": "Incorrect Flashloan Integration",
    "content": "**Update**\nThe client fixed the issue in commit `0fd7b45e0e8323a437804bcd9e6d0c373d0d0896` and provided the following explanation:\n\n> Mentioned issues were addressed in this commit, but this only can be considered fixed when VirtualPool is actually tested (not as of commit time)\n\n**File(s) affected:**`contracts/VirtualPool.vy`\n\n**Description:** The `VirtualPool` contract makes use of a crvUSD flashloan provider to amplify user arbitrage for price correction. However, the flashloan integration is incomplete.\n\n1.   The `onFlashLoan()` function needs to be external according to ERC3156.\n2.   The `onFlashLoan()` function should verify the `initiator` and `token` addresses. \n3.   The `exchange()` function calls a `FLASH.ceiling()` function that appears to be undefined based on the intended integrated flash contract, [Curve Flashlender](https://etherscan.io/address/0x26de7861e213a5351f6ed767d00e0839930e9ee1#code). \n4.   The `exchange()` function should be `@nonreentrant`.\n\n**Recommendation:** Make sure that the flashloan integration is complete and secure. Consider adding a test suite to further check the correctness of the `VirtualPool` contract.",
    "summary": "\nThe `VirtualPool` contract, which uses a crvUSD flashloan provider to increase user arbitrage, has an incomplete flashloan integration. The `onFlashLoan()` function needs to be external according to ERC3156 and should verify the addresses of `initiator` and `token`. The `exchange()` function calls a non-existent `FLASH.ceiling()` function and should also be `@nonreentrant`. The client has fixed some issues in a commit, but it is recommended to thoroughly test the contract and consider adding a test suite to ensure its correctness.",
    "report_date": "2025-08-14T16:12:11.589Z",
    "contest_prize_txt": "",
    "contest_link": "https://certificate.quantstamp.com/full/yield-basis/e07ecad3-524c-4609-b4f6-71ed7fdc3281/index.html",
    "sponsor_name": "",
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://certificate.quantstamp.com/full/yield-basis/e07ecad3-524c-4609-b4f6-71ed7fdc3281/index.html",
    "github_link": "",
    "pdf_link": "",
    "pdf_page_from": 0,
    "contest_id": "",
    "slug": "incorrect-flashloan-integration-quantstamp-yield-basis-markdown",
    "firm_name": "Quantstamp",
    "firm_logo_square": "quantstamp_square.png",
    "protocol_name": "Yield Basis",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Gereon Mendler"
            }
        },
        {
            "wardens_warden": {
                "handle": "Cameron Biniamow"
            }
        },
        {
            "wardens_warden": {
                "handle": "Jonathan Mevs"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Quantstamp",
        "logo_square": "quantstamp_square.png"
    },
    "protocols_protocol": {
        "name": "Yield Basis",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}