{
    "id": 62729,
    "kind": "GIT",
    "auditfirm_id": 3,
    "impact": "MEDIUM",
    "finders_count": 21,
    "protocol_id": 3324,
    "title": "M-6: `EverclearBridge` does not pull tokens from the Rebalancer, causing all rebalancing operations to fail",
    "content": "\nSource: https://github.com/sherlock-audit/2025-07-malda-judging/issues/177 \n\n## Found by \n0xDemon, 0xmechanic, 0xsai, 10ap17, Angry\\_Mustache\\_Man, BusinessShotgun, Cybrid, ExtraCaterpillar, IvanFitro, Sa1ntRobi, SafetyBytes, ZanyBonzy, ZeroTrust, Ziusz, bube, bulgari, dan\\_\\_vinci, davies0212, maigadoh, oxelmiguel, vangrim\n\n### Summary\n\nThe `EverclearBridge` contract does not transfer tokens from the Rebalancer contract before attempting to perform bridging operations. It assumes custody of tokens without actually calling `safeTransferFrom` to pull tokens from the Rebalancer. As a result, the bridge contract does not have the required tokens, causing all rebalancing attempts to fail.\n\n### Root Cause\n\nIn `EverclearBridge.sol`, the [`sendMsg`](https://github.com/sherlock-audit/2025-07-malda/blob/main/malda-lending/src/rebalancer/bridges/EverclearBridge.sol#L79C4-L123C6) function does not call `IERC20(_token).safeTransferFrom(msg.sender, address(this), params.amount)` to transfer tokens from the Rebalancer to itself. Without this transfer, the bridge cannot perform any bridging logic that requires token custody.\n\n### Internal Pre-conditions\n\n1. The Rebalancer approves the bridge contract to spend tokens.\n2. The Rebalancer calls `sendMsg` on the bridge contract without transferring tokens.\n\n### External Pre-conditions\n\nNone.\n\n### Attack Path\n\n1. The Rebalancer approves the bridge contract.\n2. The bridge contract attempts to perform bridging logic but fails due to lack of token custody.\n3. No tokens are bridged and rebalancing fails.\n\n### Impact\n\nAll rebalancing operations using the bridge contract will fail, resulting in a complete denial of service for cross-chain liquidity movement. This can halt protocol operations that depend on rebalancing and may lead to liquidity fragmentation or loss of protocol functionality.\n\n\n### PoC\n\n_No response_\n\n### Mitigation\n\nUpdate the `EverclearBridge` contract to call `safeTransferFrom` and pull the required tokens from the Rebalancer before proceeding with bridging logic.\n\n## Discussion\n\n**sherlock-admin2**\n\nThe protocol team fixed this issue in the following PRs/commits:\nhttps://github.com/malda-protocol/malda-lending/pull/105\n\n\n**CergyK**\n\nFix looks good. Tokens are now pulled from Rebalancer into EverclearBridge\n\n\n\n",
    "summary": "\nSummary: \nA bug was found in the `EverclearBridge` contract where it does not transfer tokens from the Rebalancer contract before attempting to perform bridging operations. This results in a denial of service for cross-chain liquidity movement and can cause protocol operations to fail. The bug has been fixed by updating the contract to call `safeTransferFrom` and pull the required tokens from the Rebalancer before proceeding with bridging logic.",
    "report_date": "2025-08-14T17:00:00.000Z",
    "contest_prize_txt": "80000 USDC",
    "contest_link": "https://app.sherlock.xyz/audits/contests/1029",
    "sponsor_name": "",
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "",
    "github_link": "https://github.com/sherlock-audit/2025-07-malda-judging/issues/177",
    "pdf_link": "",
    "pdf_page_from": 0,
    "contest_id": "1029",
    "slug": "m-6-everclearbridge-does-not-pull-tokens-from-the-rebalancer-causing-all-rebalancing-operations-to-fail-sherlock-malda-git",
    "firm_name": "Sherlock",
    "firm_logo_square": "sherlock_square.png",
    "protocol_name": "Malda",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Sa1ntRobi"
            }
        },
        {
            "wardens_warden": {
                "handle": "BusinessShotgun"
            }
        },
        {
            "wardens_warden": {
                "handle": "0xDemon"
            }
        },
        {
            "wardens_warden": {
                "handle": "ZanyBonzy"
            }
        },
        {
            "wardens_warden": {
                "handle": "dan\\_\\_vinci"
            }
        },
        {
            "wardens_warden": {
                "handle": "10ap17"
            }
        },
        {
            "wardens_warden": {
                "handle": "ZeroTrust"
            }
        },
        {
            "wardens_warden": {
                "handle": "Angry\\_Mustache\\_Man"
            }
        },
        {
            "wardens_warden": {
                "handle": "davies0212"
            }
        },
        {
            "wardens_warden": {
                "handle": "maigadoh"
            }
        },
        {
            "wardens_warden": {
                "handle": "IvanFitro"
            }
        },
        {
            "wardens_warden": {
                "handle": "ExtraCaterpillar"
            }
        },
        {
            "wardens_warden": {
                "handle": "bulgari"
            }
        },
        {
            "wardens_warden": {
                "handle": "dan\\_\\_vinci"
            }
        },
        {
            "wardens_warden": {
                "handle": "bube"
            }
        },
        {
            "wardens_warden": {
                "handle": "SafetyBytes"
            }
        },
        {
            "wardens_warden": {
                "handle": "0xmechanic"
            }
        },
        {
            "wardens_warden": {
                "handle": "oxelmiguel"
            }
        },
        {
            "wardens_warden": {
                "handle": "Cybrid"
            }
        },
        {
            "wardens_warden": {
                "handle": "0xsai"
            }
        },
        {
            "wardens_warden": {
                "handle": "Ziusz"
            }
        },
        {
            "wardens_warden": {
                "handle": "vangrim"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Sherlock",
        "logo_square": "sherlock_square.png"
    },
    "protocols_protocol": {
        "name": "Malda",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}