{
    "id": 62890,
    "kind": "PDF",
    "auditfirm_id": 6,
    "impact": "HIGH",
    "finders_count": 4,
    "protocol_id": 3419,
    "title": "Peer list resource requirements can lead to DoS",
    "content": "## Severity: High Risk\n\n## Context\ndiscovery.rs#L309-L314\n\n## Description\nA network participant can ping a node and be added to the peer list (discovery.rs#L74). However, there are a few issues:\n- The node accepts whatever IP address the peer declares, regardless of the source of the packet.\n- There is no restriction on the size of the peer list.\n- Each ping triggers a signature check.\n\nAn attacker could spin up a single fake node implementation, or several, which only handles pings and pongs, and flood the network, filling up peer lists and overloading honest nodes.\n\n## Recommendation\nPut a hard limit on the size of the peer list. It is separate from the dedicated full nodes and epoch validators list, and thus not critical to consensus. Keep validators and full nodes in the peer list and do not eject them, so that network discovery can reasonably be expected to function.\n\n## Category Labs\nFixed in commit 261a8893.\n\n## Spearbit\nFix verified.",
    "summary": "\nThis bug report describes a problem where a network participant can send a ping to a node and be added to the peer list, even if the IP address they declare is not valid. This can potentially be exploited by an attacker, who can create fake nodes and flood the network, causing it to become overloaded. The report recommends putting a limit on the size of the peer list and keeping validators and full nodes in the list to maintain network functionality. The bug has been fixed in a recent commit.",
    "report_date": "2025-09-19T00:00:00.000Z",
    "contest_prize_txt": "",
    "contest_link": "https://github.com/spearbit/portfolio/blob/master/pdfs/Monad-Spearbit-Security-Review-September-2025.pdf",
    "sponsor_name": null,
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://github.com/spearbit/portfolio/blob/master/pdfs/Monad-Spearbit-Security-Review-September-2025.pdf",
    "github_link": "",
    "pdf_link": "https://solodit-bucket.s3.amazonaws.com/storage/reports/spearbit/Monad-Spearbit-Security-Review-September-2025.pdf",
    "pdf_page_from": 16,
    "contest_id": "",
    "slug": "peer-list-resource-requirements-can-lead-to-dos-spearbit-none-monad-pdf",
    "firm_name": "Spearbit",
    "firm_logo_square": "spearbit_square.png",
    "protocol_name": "Monad",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Haxatron"
            }
        },
        {
            "wardens_warden": {
                "handle": "Dtheo"
            }
        },
        {
            "wardens_warden": {
                "handle": "Guido Vranken"
            }
        },
        {
            "wardens_warden": {
                "handle": "Rikard Hjort"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Spearbit",
        "logo_square": "spearbit_square.png"
    },
    "protocols_protocol": {
        "name": "Monad",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}