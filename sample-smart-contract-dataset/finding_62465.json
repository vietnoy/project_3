{
    "id": 62465,
    "kind": "MARKDOWN",
    "auditfirm_id": 30,
    "impact": "MEDIUM",
    "finders_count": 1,
    "protocol_id": 3412,
    "title": "[M-01] Protocol Can Permanently Lose Rewards During Periods When Zero Participants Are Staking",
    "content": "\n## Severity\n\nMedium Risk\n\n## Description\n\nThe vulnerability occurs in the reward calculation and distribution mechanism when the staking pool experiences periods with zero total supply `(_totalSupply == 0)`. During these periods, the `rewardPerToken()` function returns `rewardPerTokenStored` without accounting for the time elapsed, effectively causing rewards to accumulate in a state where they cannot be claimed by any participant.\n\nWhen `_totalSupply` is zero, the mathematical formula `((lastTimeRewardApplicable() - lastUpdateTime) * rewardRate * 1e18) / _totalSupply` cannot be computed, so the function returns the stored value. However, the `rewardRate` continues to represent active reward distribution, and time continues to pass within the reward period defined by `periodFinish`. This creates a scenario where rewards are theoretically being distributed but cannot be claimed because there are no stakers to receive them.\n\n## Location of Affected Code\n\nFile: [StakingRewards.sol](https://github.com/BeraRoot2025/bluebera-contracts/blob/5e2c5f14717718d7b4dc32729853f0c945ec3bb8/contracts/StakingRewards.sol)\n\n```solidity\nfunction rewardPerToken() public view returns (uint256) {\n    if (_totalSupply == 0) return rewardPerTokenStored;\n    return rewardPerTokenStored + ((lastTimeRewardApplicable() - lastUpdateTime) * rewardRate * 1e18) / _totalSupply;\n}\n```\n\n## Impact\n\nThe primary impact is permanent loss of protocol funds allocated for reward distribution. When reward periods experience extended periods without any stakers, the corresponding portion of rewards becomes permanently inaccessible, representing a direct financial loss to the protocol or reward provider.\n\n## Recommendation\n\nConsider implementing a reward reclaim mechanism that allows the contract owner to recover unused rewards from periods with zero participation, enabling reallocation to future reward periods or alternative distribution mechanisms.\n\n## Team Response\n\nAcknowledged.\n\n",
    "summary": "\nThe bug report describes a problem with the calculation and distribution of rewards in a staking pool. When the total supply of staked tokens is zero, the function that calculates rewards returns a stored value instead of accounting for the time elapsed. This means that rewards continue to be distributed but cannot be claimed by any stakers, resulting in a loss of funds for the protocol. The report recommends implementing a mechanism to reclaim unused rewards from periods with zero participation. The team has acknowledged the issue.",
    "report_date": "2025-09-04T00:00:00.000Z",
    "contest_prize_txt": "",
    "contest_link": "",
    "sponsor_name": null,
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://github.com/shieldify-security/audits-portfolio-md/blob/main/BeraRoot-Security-Review.md",
    "github_link": "",
    "pdf_link": "",
    "pdf_page_from": 0,
    "contest_id": "",
    "slug": "m-01-protocol-can-permanently-lose-rewards-during-periods-when-zero-participants-are-staking-shieldify-none-beraroot-markdown",
    "firm_name": "Shieldify",
    "firm_logo_square": "Shieldify_square.png",
    "protocol_name": "Beraroot",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Shieldify Security"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Shieldify",
        "logo_square": "Shieldify_square.png"
    },
    "protocols_protocol": {
        "name": "Beraroot",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}