{
    "id": 62269,
    "kind": "PDF",
    "auditfirm_id": 6,
    "impact": "LOW",
    "finders_count": 3,
    "protocol_id": 3395,
    "title": "Side effects of uninstalling a LockToVotePlugin with active proposals and locked votes",
    "content": "## LockToVotePlugin Uninstallation Report\n\n## Severity\n**Low Risk**\n\n## Context\n(No context files were provided by the reviewer)\n\n## Description\nThe current uninstallation process of the LockToVotePlugin will not revert if the LockToVotePlugin has ongoing (still open for voting) proposals with already registered votes. Once the plugin has been uninstalled and all the permissions have been revoked, it won't be possible to interact with the LockToVotePlugin anymore. This behavior will bring some side effects that will affect those users who have already cast votes on proposals that are still \"open for vote\":\n\n1. These users won't be able to unlock their votes and withdraw their tokens. They must wait for the end of the voting periods of all the proposals they have voted on. At that point they will be able to call `LockManager.unlock` and withdraw their tokens.\n2. Users will still be able to call `LockManager.lock` and lock more tokens, effectively transferring them to the LockManager. If they have no active proposal they have voted on, they will be able to instantly call `LockManager.unlock` and withdraw their tokens; otherwise, they will need to wait, as explained in the above issue.\n\n## Recommendation\nAragon should implement an \"onUninstall\" mechanism triggered once the plugin has been uninstalled that would:\n\n1. Prevent users from locking more tokens via `LockManager.lock`. That function should directly revert when the vote plugin connected to the lock manager has been uninstalled.\n2. Clean the `knownProposalIds` set in the LockManager to allow anyone to call `LockManager.unlock` and withdraw their tokens.\n\n## Aragon\nAssuming that an uninstall proposal passes on the LockToVote plugin:\n- We expect no meaningful new proposals to be created on this plugin.\n- We expect voters to stop voting in future proposals: they would be able to unlock after the uninstall proposal is settled.\n\n### Worst Case Scenario\n- They decide to vote in a proposal created after the uninstall proposal is created, and before the uninstall is applied.\n- These voters will need to wait until `endDate`.\n\n## Preferred Changes\n- Lower the maximum allowed `proposalDuration` setting to 1 month, maximum.\n- Not introduce `onUninstall`, since this requires protocol changes on OSx, and goes beyond the scope of this particular plugin.\n\n## Spearbit\nAragon has acknowledged the finding and won't implement the recommendations suggested. They have decided to reduce the duration of a proposal from 1 year to a maximum of 31 days with the PR 38. This change is welcome and will alleviate the issue described in the proposal. In the worst-case scenario, users will have their tokens locked for at most 1 month.",
    "summary": "",
    "report_date": "2025-08-28T00:00:00.000Z",
    "contest_prize_txt": "",
    "contest_link": "https://github.com/spearbit/portfolio/blob/master/pdfs/Aragon-Spearbit-Security-Review-July-2025.pdf",
    "sponsor_name": null,
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://github.com/spearbit/portfolio/blob/master/pdfs/Aragon-Spearbit-Security-Review-July-2025.pdf",
    "github_link": "",
    "pdf_link": "https://solodit-bucket.s3.amazonaws.com/storage/reports/spearbit/Aragon-Spearbit-Security-Review-July-2025.pdf",
    "pdf_page_from": 19,
    "contest_id": "",
    "slug": "side-effects-of-uninstalling-a-locktovoteplugin-with-active-proposals-and-locked-votes-spearbit-none-aragon-dao-gov-plugin-pdf",
    "firm_name": "Spearbit",
    "firm_logo_square": "spearbit_square.png",
    "protocol_name": "Aragon DAO Gov Plugin",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Om Parikh"
            }
        },
        {
            "wardens_warden": {
                "handle": "Emanuelle Ricci"
            }
        },
        {
            "wardens_warden": {
                "handle": "Patrick Drotleff"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Spearbit",
        "logo_square": "spearbit_square.png"
    },
    "protocols_protocol": {
        "name": "Aragon DAO Gov Plugin",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}