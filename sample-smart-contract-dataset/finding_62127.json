{
    "id": 62127,
    "kind": "PDF",
    "auditfirm_id": 9,
    "impact": "LOW",
    "finders_count": 2,
    "protocol_id": 3383,
    "title": "Module installation fails due to incorrect local storage parsing",
    "content": "## Module Installation Failure\n\n## Difficulty: Low\n\n## Type: Access Controls\n\n## Description\n\nThe module installation process fails because the chain ID is incorrectly parsed from local storage. The code attempts to retrieve and parse the chain ID using the code shown in Figure 8.1.\n\n```javascript\nconst currentChain = JSON.parse(localStorage.getItem(STORAGE_ETH_ACTIVE_CHAIN_KEY) ?? \"{}\")\n```\n\n**Figure 8.1:** The chain ID is parsed using this method.\n\nHowever, this results in an empty object. The storage value is in a format shown in Figure 8.2.\n\n```json\n{\n  \"@gemini.wallet.settings\": \"{\\n  \\\"fiatDisplayCurrency\\\": \\\"USD\\\"\\n}\",\n  \"@gemini.wallet.eth-active-chain\": \"{'id': '[CHAIN_ID]'}\",\n  \"@gemini.wallet.passkey-credential\": \"[...]\",\n  \"@gemini.wallet.smart-account\": \"[...]\"\n}\n```\n\n**Figure 8.2:** Storage value JSON\n\nAs a result, subsequent operations receive an undefined chain ID, causing downstream failures such as invalid API requests.\n\n## Exploit Scenario\n\nAlice, a user of the Gemini Smart Wallet, attempts to download a module to use with her wallet. However, the module installation fails since the API request is malformed.\n\n## Recommendations\n\n- **Short term:** Use the `loadObject` method to retrieve the chain ID from storage.\n- **Long term:** Add unit tests to ensure that every feature works correctly.",
    "summary": "",
    "report_date": "2025-08-15T00:00:00.000Z",
    "contest_prize_txt": "",
    "contest_link": "https://github.com/trailofbits/publications/blob/master/reviews/2025-08-gemini-smartwallet-securityreview.pdf",
    "sponsor_name": null,
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://github.com/trailofbits/publications/blob/master/reviews/2025-08-gemini-smartwallet-securityreview.pdf",
    "github_link": "",
    "pdf_link": "https://solodit-bucket.s3.amazonaws.com/storage/reports/trailofbits/2025-08-gemini-smartwallet-securityreview.pdf",
    "pdf_page_from": 23,
    "contest_id": "",
    "slug": "module-installation-fails-due-to-incorrect-local-storage-parsing-trailofbits-none-gemini-smart-wallet-pdf",
    "firm_name": "TrailOfBits",
    "firm_logo_square": "trailofbits_square.png",
    "protocol_name": "Gemini Smart Wallet",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Coriolan Pinhas Trail of Bits PUBLIC"
            }
        },
        {
            "wardens_warden": {
                "handle": "Anish Naik"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "TrailOfBits",
        "logo_square": "trailofbits_square.png"
    },
    "protocols_protocol": {
        "name": "Gemini Smart Wallet",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}