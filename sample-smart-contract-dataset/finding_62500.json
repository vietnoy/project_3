{
    "id": 62500,
    "kind": "GIT",
    "auditfirm_id": 3,
    "impact": "MEDIUM",
    "finders_count": 1,
    "protocol_id": 3104,
    "title": "M-8: Emission rewards will keep accruing even the yield strategy is empty",
    "content": "\nSource: https://github.com/sherlock-audit/2025-06-notional-exponent-judging/issues/511 \n\n## Found by \nmstpr-brainbot\n\n### Summary\n\nWhen there are no depositors in the yield strategy, emission rewards should stop accruing. However, the current implementation incorrectly assumes that effectiveSupply will never be zero its minimum value is hardcoded to 1e6 due to virtual shares. As a result, rewards continue to accrue even when the strategy is completely empty, which is unintended behavior.\n\n### Root Cause\n\nAs we can see [here](https://github.com/sherlock-audit/2025-06-notional-exponent/blob/82c87105f6b32bb362d7523356f235b5b07509f9/notional-v4/src/rewards/AbstractRewardManager.sol#L298), when `effectiveSupply < 0`, reward emissions should **not** accrueâ€”this is intended to ensure rewards are only distributed when there are actual depositors in the yield strategy.\n\nHowever, this assumption is incorrect because `effectiveSupply` is **never zero** due to `VIRTUAL_SHARES`, even when there are no real depositors!\nSee:\n[https://github.com/sherlock-audit/2025-06-notional-exponent/blob/82c87105f6b32bb362d7523356f235b5b07509f9/notional-v4/src/AbstractYieldStrategy.sol#L149-L151](https://github.com/sherlock-audit/2025-06-notional-exponent/blob/82c87105f6b32bb362d7523356f235b5b07509f9/notional-v4/src/AbstractYieldStrategy.sol#L149-L151)\n\n\n### Internal Pre-conditions\n\nNone needed\n\n### External Pre-conditions\n\nNone needed\n\n### Attack Path\n\nHappens naturally \n\n### Impact\n\nAll the emission rewards will accrue to rewardPerToken unnecessarily. Functionality broken whats intended is not prevented. \n\n### PoC\n\n_No response_\n\n### Mitigation\n\ninstead of checking effective supply against \"0\" check against VIRTUAL_SHARES or use totalSupply.\n\n",
    "summary": "\nThe bug report is about a mistake in the implementation of a yield strategy, where emission rewards continue to accrue even when the strategy has no depositors. This is due to a wrong assumption that the effective supply will never be zero, which is not the case because of virtual shares. This unintended behavior results in all emission rewards going to rewardPerToken unnecessarily. The report suggests checking against virtual shares or using total supply instead of checking against zero.",
    "report_date": "2025-07-18T15:00:00.000Z",
    "contest_prize_txt": "75500 USDC",
    "contest_link": "https://app.sherlock.xyz/audits/contests/1001",
    "sponsor_name": "",
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "",
    "github_link": "https://github.com/sherlock-audit/2025-06-notional-exponent-judging/issues/511",
    "pdf_link": "",
    "pdf_page_from": 0,
    "contest_id": "1001",
    "slug": "m-8-emission-rewards-will-keep-accruing-even-the-yield-strategy-is-empty-sherlock-notional-exponent-git",
    "firm_name": "Sherlock",
    "firm_logo_square": "sherlock_square.png",
    "protocol_name": "Notional Exponent",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "mstpr-brainbot"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Sherlock",
        "logo_square": "sherlock_square.png"
    },
    "protocols_protocol": {
        "name": "Notional Exponent",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}