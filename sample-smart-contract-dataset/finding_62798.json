{
    "id": 62798,
    "kind": "MARKDOWN",
    "auditfirm_id": 37,
    "impact": "LOW",
    "finders_count": 3,
    "protocol_id": 3446,
    "title": "Users Have No Access to Owned Tokens",
    "content": "**Update**\nMarked as \"Fixed\" by the client. Addressed in: `2bb4896a06e1f258c6e12f3d3d3fb55876b5fa38`.\n\n![Image 31: Alert icon](https://certificate.quantstamp.com/full/camp-nft/94cdb738-1a01-4f6c-8632-3bdec427161e/static/media/info-icon-alert.3c9578483b1cf3181c9bfb6fec7dc641.svg)\n\n**Update**\nThe `hasAccess()` function has been removed and replaced with off-chain tracking of the subgraph to validate access privileges.\n\n**File(s) affected:**`RoyaltyModule.sol`, `Marketplace.sol`\n\n**Description:** Access to tokens can be bought via the `Marketplace` contract following a subscription model. The `hasAccess()` function is used by offchain components to evaluate if a user has access to some token. Currently, this depends on the state of the token and the state of the subscription. Therefore, users need subscriptions to their own tokens to have the expected access.\n\nA similar issue arises during the token minting process, where the royalty module ensures that the minter had subscriptions to all parent tokens in the past. Again, minters are required to have had subscriptions to their own tokens.\n\n**Recommendation:** The `hasAccess()` function should return `true` if the user owns the queried token.\n\n```\nfunction hasAccess(address user, uint256 tokenId) external view returns (bool) {\n    if (ipToken.dataStatus(tokenId) != IIpNFT.DataStatus.ACTIVE) return false;\n    if (user == IpToken.ownerOf(tokenID)) return true; // <-- new check for token ownership\n    return subscriptionExpiry[tokenId][user] > block.timestamp;\n}\n```\n\nAdd a similar check to the parent validation in the `setParentIpsAndRoyaltyPercents()` function.",
    "summary": "",
    "report_date": "2025-09-15T14:18:47.035Z",
    "contest_prize_txt": "",
    "contest_link": "https://certificate.quantstamp.com/full/camp-nft/94cdb738-1a01-4f6c-8632-3bdec427161e/index.html",
    "sponsor_name": "",
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://certificate.quantstamp.com/full/camp-nft/94cdb738-1a01-4f6c-8632-3bdec427161e/index.html",
    "github_link": "",
    "pdf_link": "",
    "pdf_page_from": 0,
    "contest_id": "",
    "slug": "users-have-no-access-to-owned-tokens-quantstamp-camp-nft-markdown",
    "firm_name": "Quantstamp",
    "firm_logo_square": "quantstamp_square.png",
    "protocol_name": "Camp - NFT",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Paul Clemson"
            }
        },
        {
            "wardens_warden": {
                "handle": "Gereon Mendler"
            }
        },
        {
            "wardens_warden": {
                "handle": "Tim Sigl"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Quantstamp",
        "logo_square": "quantstamp_square.png"
    },
    "protocols_protocol": {
        "name": "Camp - NFT",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}