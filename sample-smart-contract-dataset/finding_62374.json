{
    "id": 62374,
    "kind": "MARKDOWN",
    "auditfirm_id": 34,
    "impact": "LOW",
    "finders_count": 1,
    "protocol_id": 1390,
    "title": "[ASTRO-1] Missing array parameters length check",
    "content": "**Severity:** Low\n\n**Path:** Crate.sol, Allocator.sol\n\n**Description:** In the following locations, there are at least 2 arrays as function parameters that require the same length but are missing these length checks:\n\n- contracts/Crate.sol:dispatchAssets (L479-500)\n\n- contracts/Crate.sol:estimateDispatchCost (L1037-1049)\n\n- contracts/Allocator.sol:dispatchAssets(L182-203)\n```\ncontract Crate {\n\n    [...]    \n\n    function dispatchAssets(\n        uint256[] calldata _amounts,\n        uint256[] calldata _chainIds,\n        uint256[] calldata _msgValues\n    ) external payable onlyOwner {\n        for (uint256 i = 0; i < _amounts.length; i++) {\n            ChainData memory data = chainData[_chainIds[i]];\n            // checks\n            if (data.maxDeposit == 0) revert ChainError(); // Chain not active\n            if (data.maxDeposit <= data.debt + _amounts[i])\n                revert AmountTooHigh(data.maxDeposit); // No more funds can be sent to this chain\n\n            chainData[_chainIds[i]].debt += _amounts[i];\n            totalRemoteAssets += _amounts[i];\n            asset.safeTransfer(data.bridge, _amounts[i]);\n            if (block.chainid != _chainIds[i]) {\n                IBridgeConnectorHome(data.bridge).bridgeFunds{\n                    value: _msgValues[i]\n                }(_amounts[i], _chainIds[i]);\n            }\n        }\n    }\n    \n    [...]\n    \n    function estimateDispatchCost(\n        uint256[] calldata _chainIds,\n        uint256[] calldata _amounts\n    ) external view returns (uint256[] memory) {\n        uint256 length = _chainIds.length;\n        uint256[] memory nativeCost = new uint256[](length);\n        for (uint256 i; i < length; i++) {\n            if (_chainIds[i] == block.chainid) continue;\n            nativeCost[i] = IBridgeConnectorHome(chainData[_chainIds[i]].bridge)\n                .estimateBridgeCost(_chainIds[i], _amounts[i]);\n        }\n        return (nativeCost);\n    }\n    \n    [...]\n  \n  }\n  \n  Contract Allocator {\n  \n  [...]\n  \n  \tfunction dispatchAssets(\n\t\tuint256[] calldata _amounts,  // @audit array lenghts\n\t\taddress[] calldata _strategies\n\t) external onlyOwner {\n\t\tfor (uint256 i; i < _amounts.length; i++) {\n\t\t\tisWhitelisted(_strategies[i]);\n\n\t\t\tuint256 debt = strategiesData[_strategies[i]].debt;\n\n\t\t\tif (strategiesData[_strategies[i]].maxDeposit <= debt + _amounts[i])\n\t\t\t\trevert MaxDepositReached(_strategies[i]);\n\n\t\t\tstrategiesData[_strategies[i]].debt += _amounts[i];\n\t\t\ttotalStrategysDebt += _amounts[i];\n\n\t\t\tIERC20(asset).safeTransfer(_strategies[i], _amounts[i]);\n\n\t\t\temit StrategyUpdate(_strategies[i], debt += _amounts[i]);\n\t\t}\n\n\t\temit ChainDebtUpdate(totalChainDebt());\n\t}\n\t\n\t[...]\n\t\n\t}\n```\n\n**Remediation:**  We would recommend checking the length of the input parameters so that the error is caught to improve user experience.\n\nFor example:\n```\nrequire(array1.length == array2.length, \"Arrays length mismatch\");\n```\n\n**Status:** Fixed\n\n- - -",
    "summary": "",
    "report_date": "2023-04-17T00:00:00.000Z",
    "contest_prize_txt": "",
    "contest_link": "",
    "sponsor_name": null,
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://github.com/solodit/solodit_content/blob/main/reports/Hexens/2023-04-17-Astrolab.md",
    "github_link": "",
    "pdf_link": "",
    "pdf_page_from": 0,
    "contest_id": "",
    "slug": "astro-1-missing-array-parameters-length-check-hexens-none-astrolab-markdown",
    "firm_name": "Hexens",
    "firm_logo_square": "Hexens_square.png",
    "protocol_name": "Astrolab",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Hexens"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Hexens",
        "logo_square": "Hexens_square.png"
    },
    "protocols_protocol": {
        "name": "Astrolab",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}