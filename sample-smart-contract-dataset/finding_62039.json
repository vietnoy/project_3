{
    "id": 62039,
    "kind": "MARKDOWN",
    "auditfirm_id": 37,
    "impact": "MEDIUM",
    "finders_count": 4,
    "protocol_id": 3368,
    "title": "Getting Max Staking Rewards Possible While Bypassing the Lockup Periods",
    "content": "**Update**\nMarked as \"Fixed\" by the client. Addressed in: `b175349`.\n\n![Image 42: Alert icon](https://certificate.quantstamp.com/full/sapien/ffb7e698-6178-46f0-8df8-52e537af70c0/static/media/success-icon-alert.4e26c8d3b65fdf9f4f0789a4086052ba.svg)\n\n**Update**\nMarked as \"Fixed\" by the client. Addressed in: `228ae219c5478f375bed56376ffba8538ea2f09e`. The client provided the following explanation:\n\n> The vulnerability was fixed by adding lock period validation checks across unstaking functions.\n\n![Image 43: Alert icon](https://certificate.quantstamp.com/full/sapien/ffb7e698-6178-46f0-8df8-52e537af70c0/static/media/success-icon-alert.4e26c8d3b65fdf9f4f0789a4086052ba.svg)\n\n**Update**\nMarked as \"Fixed\" by the client. Addressed in: `228ae219c5478f375bed56376ffba8538ea2f09e`. The client provided the following explanation:\n\n> The vulnerability was fixed by adding lock period validation checks across unstaking functions.\n\n**File(s) affected:**`SapienStaking.sol`\n\n**Description:** The staking contract determines the multiplier a user gets depending on the staking amount and the lockup period. Where the lockup period is the most important factor since it determines the max multiplier. However, any of the unstake-related functions check if the lockup period has actually elapsed. There are two consequences:\n\n1.   A user can stake the needed amount for the max multiplier for 12 months to get the maximum rewards but only lock up the funds for two days after calling `initiateUnstake()` immediately after staking.\n2.   A user can mistakenly call `instantUnstake()` after the lockup period has ended which would cost an unnecessary penalty.\n\n**Recommendation:** We recommend to check that the lockup period has ended before allowing the user to initiate the unstaking process. Additionally, make sure the `instantUnstake()` can only be called before the lockup period has ended to avoid unnecessary penalties.",
    "summary": "\nThe client has marked a bug as \"Fixed\" and provided an explanation for the fix. The bug was related to the staking contract, which determines the multiplier a user gets based on staking amount and lockup period. However, the contract did not check if the lockup period had actually elapsed before allowing unstaking, leading to two potential consequences. The recommendation is to check the lockup period before initiating unstaking and limit the use of `instantUnstake()` to before the lockup period has ended.",
    "report_date": "2025-03-30T00:00:00.000Z",
    "contest_prize_txt": "",
    "contest_link": "https://certificate.quantstamp.com/full/sapien/ffb7e698-6178-46f0-8df8-52e537af70c0/index.html",
    "sponsor_name": "",
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://certificate.quantstamp.com/full/sapien/ffb7e698-6178-46f0-8df8-52e537af70c0/index.html",
    "github_link": "",
    "pdf_link": "",
    "pdf_page_from": 0,
    "contest_id": "",
    "slug": "getting-max-staking-rewards-possible-while-bypassing-the-lockup-periods-quantstamp-sapien-markdown",
    "firm_name": "Quantstamp",
    "firm_logo_square": "quantstamp_square.png",
    "protocol_name": "Sapien",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Paul Clemson"
            }
        },
        {
            "wardens_warden": {
                "handle": "Julio Aguilar"
            }
        },
        {
            "wardens_warden": {
                "handle": "Mostafa Yassin"
            }
        },
        {
            "wardens_warden": {
                "handle": "Tim Sigl"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Quantstamp",
        "logo_square": "quantstamp_square.png"
    },
    "protocols_protocol": {
        "name": "Sapien",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}