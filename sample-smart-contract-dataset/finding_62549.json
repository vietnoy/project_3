{
    "id": 62549,
    "kind": "MARKDOWN",
    "auditfirm_id": 16,
    "impact": "MEDIUM",
    "finders_count": 1,
    "protocol_id": 3420,
    "title": "[M-05] Potential out-of-bounds in `removeCardBundlesFromPacketPool`",
    "content": "\n_Resolved_\n\n## Severity\n\n**Impact:** Medium\n\n**Likelihood:** Medium\n\n## Description\n\nThe `removeCardBundlesFromPacketPool` function in the `CardAllocationPool` contract has a critical flaw that could lead to `out-of-bounds` access errors.\n\nWhen removing card bundles, the function **swaps the selected bundle with the last unselected bundle and then pops the last element from the array.**\n\n```solidity\n            // Swap selected card bundle with last unselected card bundle and pop\n            cardBundles[index] = cardBundles[cardBundles.length - 1];\n            cardBundles.pop();\n```\n\nHowever, if the function attempts to remove bundles in a sequential order (e.g., removing `bundle0` and `bundle2` from an array of three bundles), the indices of the remaining bundles will change after the first removal and the length will decrease by `1`.\n\nFor instance, if the initial array is `[bundle0, bundle1, bundle2]` and `bundle0` is removed first, the array becomes `[bundle2, bundle1]`, but the function may still attempt to access `cardBundles[2]` in order to remove `bundle2`, which no longer exists in that index, leading to a potential runtime error.\n\n\n## Recommendations\n\nModify the logic or the input `cardBundleIndexes` should be in descending order.\n\n\n\n",
    "summary": "\nThis bug report addresses a flaw in the `removeCardBundlesFromPacketPool` function in the `CardAllocationPool` contract. This function has the potential to cause `out-of-bounds` errors due to the way it removes card bundles. If the function tries to remove bundles in a sequential order, the indices of the remaining bundles will change, causing the function to try and access bundles that no longer exist. To fix this issue, the logic of the function should be modified or the input `cardBundleIndexes` should be in descending order. ",
    "report_date": "2025-09-11T00:00:00.000Z",
    "contest_prize_txt": "",
    "contest_link": "",
    "sponsor_name": null,
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://github.com/pashov/audits/blob/master/team/md/RipIt-security-review_2025-04-25.md",
    "github_link": "",
    "pdf_link": "",
    "pdf_page_from": 0,
    "contest_id": "",
    "slug": "m-05-potential-out-of-bounds-in-removecardbundlesfrompacketpool-pashov-audit-group-none-ripit_2025-04-25-markdown",
    "firm_name": "Pashov Audit Group",
    "firm_logo_square": "Pashov_square.png",
    "protocol_name": "RipIt_2025-04-25",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Pashov Audit Group"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Pashov Audit Group",
        "logo_square": "Pashov_square.png"
    },
    "protocols_protocol": {
        "name": "RipIt_2025-04-25",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}