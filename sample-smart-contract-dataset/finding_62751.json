{
    "id": 62751,
    "kind": "PDF",
    "auditfirm_id": 6,
    "impact": "LOW",
    "finders_count": 2,
    "protocol_id": 3441,
    "title": "CSS Injection in Chart Component",
    "content": "## Security Issue Report\n\n### Severity: Low Risk\n\n### Context\n`src/components/ui/chart/index.tsx#L70-L94`\n\n### Description\nThe chart component uses `dangerouslySetInnerHTML` to inject CSS styles dynamically. The `id` parameter is directly interpolated into CSS selectors without proper sanitization, potentially allowing CSS injection that could lead to XSS.\n\nThe current `id` is set using `React.useId();`. However, if in the future the `id` parameter can be controlled by user input (e.g., through URL parameters, form inputs, or API responses), an attacker could inject malicious CSS. \n\nAlthough this is theoretical, it is always good practice to ensure any data flowing into `dangerouslySetInnerHTML` is sanitized. Various methods have been tried to control or modify the data flowing into this section, but these have been unsuccessful. This does not mean it may not be a future option that could lead to XSS.\n\n### Example\n```css\n[data-chart=\"<img src=x onerror=alert(/quotesingle.ts1XSS/quotesingle.ts1)>\"] {\n  --color-primary: red;\n}\n```\n\nIn the context of the application, XSS would be critical as executing JavaScript can interact with a user's already connected wallet on the origin and appear to be a legitimate transaction executed under `test.shfin.app`.\n\n### Proof of Concept\n- **File:** `app-main/src/components/ui/chart.tsx#L73-L94`\n  \n  ```jsx\n  return (\n    <style\n      // biome-ignore lint/security/noDangerouslySetInnerHtml: <shadcn component>\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n              ${prefix} [data-chart=${id}] {\n                ${colorConfig\n                 .map(([key, itemConfig]) => {\n                   const color = itemConfig.theme?.[theme as keyof typeof itemConfig.theme] || itemConfig.color;\n                   return color ? `--color-${key}: ${color};` : null;\n                 })\n                 .join(\"\\n\")}\n              }\n            `\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  );\n  ```\n\n- **File:** `app-main/src/components/ui/chart/index.tsx#L70-L90`\n  \n  ```jsx\n  return (\n    <style\n      // biome-ignore lint/security/noDangerouslySetInnerHtml: Allow to get colors into chart (shadcn recommendation)\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n              ${prefix} [data-chart=${id}] {\n                ${colorConfig\n                 .map(([key, itemConfig]) => {\n                   const color = itemConfig.theme?.[theme as keyof typeof itemConfig.theme] || itemConfig.color;\n                   return color ? `--color-${key}: ${color};` : null;\n                 })\n                 .join(\"\\n\")}\n              }\n            `\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  );\n  ```\n\n### Likelihood\nLow\n\n### Impact\nHigh\n\n### Recommendation\nUse filtering to ensure it can prevent CSS injection attacks. Ensure the `id` can only contain safe characters that won't break CSS selectors or allow injection of malicious CSS/JavaScript:\n\n```javascript\nconst sanitizedId = id.replace(/[^a-zA-Z0-9-_]/g, '');\n```\n\n### Steakhouse\nFixed in PR 4.\n\n### Spearbit\nFix verified. `dangerouslySetInnerHTML` was removed.",
    "summary": "",
    "report_date": "2025-09-25T00:00:00.000Z",
    "contest_prize_txt": "",
    "contest_link": "https://github.com/spearbit/portfolio/blob/master/pdfs/Steakhouse-App-Web2-Spearbit-Security-Review-September-2025.pdf",
    "sponsor_name": null,
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://github.com/spearbit/portfolio/blob/master/pdfs/Steakhouse-App-Web2-Spearbit-Security-Review-September-2025.pdf",
    "github_link": "",
    "pdf_link": "https://solodit-bucket.s3.amazonaws.com/storage/reports/spearbit/Steakhouse-App-Web2-Spearbit-Security-Review-September-2025.pdf",
    "pdf_page_from": 5,
    "contest_id": "",
    "slug": "css-injection-in-chart-component-spearbit-none-steakhouse-app-pdf",
    "firm_name": "Spearbit",
    "firm_logo_square": "spearbit_square.png",
    "protocol_name": "Steakhouse App",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Dreyand"
            }
        },
        {
            "wardens_warden": {
                "handle": "Mikey96"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Spearbit",
        "logo_square": "spearbit_square.png"
    },
    "protocols_protocol": {
        "name": "Steakhouse App",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}