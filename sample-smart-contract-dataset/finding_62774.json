{
    "id": 62774,
    "kind": "MARKDOWN",
    "auditfirm_id": 37,
    "impact": "LOW",
    "finders_count": 3,
    "protocol_id": 3444,
    "title": "Unboxed Accounts May Trigger Stack Overflows Causing Instruction Failure",
    "content": "**Update**\nMarked as \"Fixed\" by the client. Addressed in: `df5b47aca0adc8f8f8f139b891547f20f70a7095`.\n\n![Image 10: Alert icon](https://certificate.quantstamp.com/full/on-re-solana-diff/b36b9c22-ed00-48e4-bbd1-66f98285a37b/static/media/info-icon-alert.3c9578483b1cf3181c9bfb6fec7dc641.svg)\n\n**Update**\nThe fix introduces the use of `anchor_spl::token_interface::TokenAccount`, enabling compatibility with both the legacy SPL Token program and the Solana Token-2022 program.\n\n**File(s) affected:**`programs/onreapp/src/instructions/take_offer_one_permissionless.rs`\n\n**Description:** In multiple places, accounts are held directly on the stack (e.g., `Account<'info, T>`). However, large or numerous account structs combined with deeper call stacks can exceed per-frame limits and cause runtime access violations, leading to transaction reverts. Practically, this manifests as stack overflow errors, producing instruction failures and degraded UX/temporary denial of service for affected flows. This directly affects reliability and user experience.\n\n**Recommendation:** Consider applying heap allocation for larger account types and interfaces, for example:\n\n*   Replace stack-allocated accounts with `Box<Account<'info, T>>` where appropriate.\n*   Use `InterfaceAccount<'info, TokenAccount>` (via `token_interface`) for SPL token accounts.\n*   Use `AccountInfo<'info>` for PDAs that donâ€™t require Anchor deserialization.\n\nMoreover, it is recommended to ensure that the Solana CLI is up to date, as ongoing improvements to the compiler and testing framework may impact results. For example, running tests with Solana CLI v2.3.9 resulted in 8 failing tests related to this finding.",
    "summary": "",
    "report_date": "2025-09-30T00:19:35.218Z",
    "contest_prize_txt": "",
    "contest_link": "https://certificate.quantstamp.com/full/on-re-solana-diff/b36b9c22-ed00-48e4-bbd1-66f98285a37b/index.html",
    "sponsor_name": "",
    "sponsor_link": "",
    "quality_score": 5,
    "general_score": 0,
    "source_link": "https://certificate.quantstamp.com/full/on-re-solana-diff/b36b9c22-ed00-48e4-bbd1-66f98285a37b/index.html",
    "github_link": "",
    "pdf_link": "",
    "pdf_page_from": 0,
    "contest_id": "",
    "slug": "unboxed-accounts-may-trigger-stack-overflows-causing-instruction-failure-quantstamp-onre-solana-diff-markdown",
    "firm_name": "Quantstamp",
    "firm_logo_square": "quantstamp_square.png",
    "protocol_name": "OnRe Solana Diff",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Paul Clemson"
            }
        },
        {
            "wardens_warden": {
                "handle": "Hamed Mohammadi"
            }
        },
        {
            "wardens_warden": {
                "handle": "Darren Jensen"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Quantstamp",
        "logo_square": "quantstamp_square.png"
    },
    "protocols_protocol": {
        "name": "OnRe Solana Diff",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}