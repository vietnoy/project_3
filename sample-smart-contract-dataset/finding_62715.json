{
    "id": 62715,
    "kind": "MARKDOWN",
    "auditfirm_id": 32,
    "impact": "HIGH",
    "finders_count": 1,
    "protocol_id": 3438,
    "title": "[C-01] First Deposit Can Result in Zero Shares Due to Direct Token Transfer",
    "content": "\n## Severity\n\nCritical\n\n## Description\n\nThe StakedUSH vault is vulnerable to zero share deposits when USH tokens are sent directly to the contract.\nBecause the vault calculates shares based on totalSupply and totalAssets, a direct token transfer increases totalAssets without increasing totalSupply.\nAs a result, legitimate depositor will receive 0 shares for a positive deposit, breaking fair share distribution and potentially locking user funds.\n\nRoot Cause:\nThe sUSH vault calculates shares using the formula:\n\nshares = (assets * (totalSupply + decimalsOffset)) / (totalAssets + 1)\n\nIf a user directly transfers USH to the vault contract (bypassing deposit()), the vaultâ€™s totalAssets increases while totalSupply remains 0.\n\nWhen the next user calls deposit(), the formula becomes:\n\n(assets * (0 + 0)) / (totalAssets + 1) = 0\n\nThus, the user receives 0 shares (REVERTS), even though they tried depositing a positive amount of assets.\n\n## Team Response\n\nFixed.\n\n",
    "summary": "\nThe StakedUSH vault has a critical bug that allows for zero share deposits when USH tokens are sent directly to the contract. This is because the vault calculates shares based on totalSupply and totalAssets, which can be manipulated when tokens are sent directly to the contract. This can result in legitimate depositors receiving 0 shares and potentially losing their funds. The root cause of this bug is the way the vault calculates shares using a formula that does not account for direct token transfers. The team has fixed this bug.",
    "report_date": "2025-08-26T00:00:00.000Z",
    "contest_prize_txt": "",
    "contest_link": "",
    "sponsor_name": null,
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://github.com/Kann-Audits/Kann-Audits/blob/main/reports/md-format/private-audits-reports/ManifestFinance-security-review_2025-08-26.md",
    "github_link": "",
    "pdf_link": "",
    "pdf_page_from": 0,
    "contest_id": "",
    "slug": "c-01-first-deposit-can-result-in-zero-shares-due-to-direct-token-transfer-kann-none-manifestfinance-security-review_2025-08-26-markdown",
    "firm_name": "Kann",
    "firm_logo_square": "Kann_Audits_square.png",
    "protocol_name": "ManifestFinance-security-review_2025-08-26",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Kann"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Kann",
        "logo_square": "Kann_Audits_square.png"
    },
    "protocols_protocol": {
        "name": "ManifestFinance-security-review_2025-08-26",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}