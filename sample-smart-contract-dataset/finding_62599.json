{
    "id": 62599,
    "kind": "MARKDOWN",
    "auditfirm_id": 16,
    "impact": "LOW",
    "finders_count": 1,
    "protocol_id": 3421,
    "title": "[L-02] Stuck fees in `PacketStore` upon `paymentToken` change without withdrawal",
    "content": "\n_Resolved_\n\nIn the `PacketStore.setPaymentToken()` function, the accepted payment token is changed without first withdrawing any accumulated fees that have yet to be transferred, which would result in these fees of the old payment token being stuck in the contract:\n\n```solidity\n  function setPaymentToken(\n        address newTokenAddress\n    ) external onlyRole(SUPER_ADMIN_ROLE) {\n        if (newTokenAddress == address(0)) revert InvalidAddress();\n        paymentToken = IERC20(newTokenAddress);\n        emit PaymentTokenUpdated(newTokenAddress);\n    }\n```\n\nRecommendation:\nBefore changing the `paymentToken`, ensure that accumulated fees are collected via the `withdrawFunds()` function.\n\n\n\n",
    "summary": "",
    "report_date": "2025-09-11T00:00:00.000Z",
    "contest_prize_txt": "",
    "contest_link": "",
    "sponsor_name": null,
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://github.com/pashov/audits/blob/master/team/md/RipIt-security-review_2025-05-10.md",
    "github_link": "",
    "pdf_link": "",
    "pdf_page_from": 0,
    "contest_id": "",
    "slug": "l-02-stuck-fees-in-packetstore-upon-paymenttoken-change-without-withdrawal-pashov-audit-group-none-ripit_2025-05-10-markdown",
    "firm_name": "Pashov Audit Group",
    "firm_logo_square": "Pashov_square.png",
    "protocol_name": "RipIt_2025-05-10",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Pashov Audit Group"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Pashov Audit Group",
        "logo_square": "Pashov_square.png"
    },
    "protocols_protocol": {
        "name": "RipIt_2025-05-10",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}