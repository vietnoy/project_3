{
    "id": 62797,
    "kind": "MARKDOWN",
    "auditfirm_id": 37,
    "impact": "MEDIUM",
    "finders_count": 3,
    "protocol_id": 3446,
    "title": "Maximizing Royalties by Frontrunning Token Minting",
    "content": "**Update**\nMarked as \"Fixed\" by the client. Addressed in: `1a872e055aed4d28b0795347d1a2b688ff0e19de`.\n\n**File(s) affected:**`RoyaltyModule.sol`, `IpNFT.sol`\n\n**Description:** Any token can have up to 8 parent tokens, whose owners receive a share of all generated profit. This revenue split is set in stone during the minting process according to the royalty terms of the involved tokens. The `RoyaltyModule` ensures that the total sum of royalties does not exceed 100%. If however the total is less than 100%, the token owner of a listed parent is incentivized to frontrun the minting transaction to maximize their royalty. It may therefore seem reasonable to suggest users to ensure that all relevant royalties add up to 100%, but this may not be desired by the minter to ensure usability for derivative tokens.\n\n**Exploit Scenario:**\n\n1.   Alice submits a mint transaction for a token with 3 parents, each with a 10% royalty share, and the new token has 15%. \n2.   Mallory is the owner of a parent token. She frontruns Alice transaction, calling `updateTerms()` to change her royalty to 65%. \n3.   Alice transaction is executed, but she will only receive 15% of generated revenue instead of the expected 70%.\n4.   Mallory can change her terms back to the original values, without affecting the revenue split for the minted token.\n\n**Recommendation:** We suggest limiting the royalty share of any token to 100/9%. This ensures that any combination of tokens can be combined into derivative tokens, and limits the exploitable profit for the outlined issue. Otherwise, force a minting user to pass along the expected terms of the parent tokens, and revert if they do not match.",
    "summary": "\nThis bug report discusses an issue with the `RoyaltyModule` in the `RoyaltyModule.sol` and `IpNFT.sol` files. The module is responsible for splitting profits between token owners, but there is a bug that allows someone to manipulate the profit distribution. This can happen when a token with multiple parents is minted and one of the parent token owners changes their royalty share before the transaction is completed. This results in the minting user receiving less profit than expected. The report recommends limiting the royalty share of any token to 100/9% or forcing the minting user to pass along the expected terms of the parent tokens.",
    "report_date": "2025-09-15T14:18:47.035Z",
    "contest_prize_txt": "",
    "contest_link": "https://certificate.quantstamp.com/full/camp-nft/94cdb738-1a01-4f6c-8632-3bdec427161e/index.html",
    "sponsor_name": "",
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://certificate.quantstamp.com/full/camp-nft/94cdb738-1a01-4f6c-8632-3bdec427161e/index.html",
    "github_link": "",
    "pdf_link": "",
    "pdf_page_from": 0,
    "contest_id": "",
    "slug": "maximizing-royalties-by-frontrunning-token-minting-quantstamp-camp-nft-markdown",
    "firm_name": "Quantstamp",
    "firm_logo_square": "quantstamp_square.png",
    "protocol_name": "Camp - NFT",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Paul Clemson"
            }
        },
        {
            "wardens_warden": {
                "handle": "Gereon Mendler"
            }
        },
        {
            "wardens_warden": {
                "handle": "Tim Sigl"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Quantstamp",
        "logo_square": "quantstamp_square.png"
    },
    "protocols_protocol": {
        "name": "Camp - NFT",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}