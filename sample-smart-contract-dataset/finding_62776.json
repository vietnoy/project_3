{
    "id": 62776,
    "kind": "MARKDOWN",
    "auditfirm_id": 37,
    "impact": "HIGH",
    "finders_count": 3,
    "protocol_id": 3426,
    "title": "User Deposit May Not Cover Bridging Fees",
    "content": "**Update**\nMarked as \"Fixed\" by the client. Addressed in: `95fad25a5770015dba8595595249a9fe8257b35e`.\n\nAdditional fixes were made to improve overall contract accounting. Final related commit: `3f19c068cfdc88d63caac061aacaa41585d1a516`\n\n**File(s) affected:**`CampTimelockEscrowNativeOFT.sol`\n\n**Description:** The `send()` operation incurs additional fees exceeding the `_originalAmount` recorded during the initial deposit using the `bridgeOut()` function. This total value is calculated in the `_bridgeNativeTokens()` functions, and then paid from the contract balance. However, there is no validation that this fee is paid during the initial deposit. In its current form, the contract may run out of funds while still having unprocessed queued deposits.\n\n**Recommendation:** Ensure that the original deposit transfer of native tokens includes the incurred fees and the required native tokens (see [](https://certificate.quantstamp.com/full/camp/ae830654-5f2b-4d21-aba2-1de572092da6/index.html#findings-qs1)[CAMP-1](https://certificate.quantstamp.com/full/camp/ae830654-5f2b-4d21-aba2-1de572092da6/index.html#findings-qs1)) by checking against `msg.value`",
    "summary": "\nThis bug report states that a client has marked a bug as \"Fixed\" and has made additional improvements to the contract accounting. The specific file affected is `CampTimelockEscrowNativeOFT.sol`. The issue is that the `send()` operation incurs additional fees that are not taken into account during the initial deposit using the `bridgeOut()` function. This can lead to the contract running out of funds while still having unprocessed deposits. The recommendation is to ensure that the original deposit transfer includes the incurred fees and required native tokens by checking against `msg.value`.",
    "report_date": "2025-09-15T14:22:57.388Z",
    "contest_prize_txt": "",
    "contest_link": "https://certificate.quantstamp.com/full/camp/ae830654-5f2b-4d21-aba2-1de572092da6/index.html",
    "sponsor_name": "",
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://certificate.quantstamp.com/full/camp/ae830654-5f2b-4d21-aba2-1de572092da6/index.html",
    "github_link": "",
    "pdf_link": "",
    "pdf_page_from": 0,
    "contest_id": "",
    "slug": "user-deposit-may-not-cover-bridging-fees-quantstamp-camp-markdown",
    "firm_name": "Quantstamp",
    "firm_logo_square": "quantstamp_square.png",
    "protocol_name": "Camp",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Paul Clemson"
            }
        },
        {
            "wardens_warden": {
                "handle": "Gereon Mendler"
            }
        },
        {
            "wardens_warden": {
                "handle": "Andy Lin"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Quantstamp",
        "logo_square": "quantstamp_square.png"
    },
    "protocols_protocol": {
        "name": "Camp",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}