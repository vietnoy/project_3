{
    "id": 62273,
    "kind": "PDF",
    "auditfirm_id": 6,
    "impact": "LOW",
    "finders_count": 3,
    "protocol_id": 3395,
    "title": "isContract and _supportsErc20 checks can produce false positives",
    "content": "## Severity: Low Risk\n\n## Context\nLockToVotePluginSetup.sol#L83-L87\n\n## Description\nThe token validation logic using `isContract()` and `_supportsErc20()` can produce false positives, potentially allowing non-compliant or malicious tokens to bypass validation checks. With EIP-7702, EOAs can temporarily have contract code during transaction execution, causing `isContract()` to return true for accounts that aren't actually contracts. Also, `isContract` has been deprecated upstream.\n\nAdditionally, `_supportsErc20()` performs static calls to check for `balanceOf`, `allowance`, and `totalSupply` functions, but malicious contracts can implement these function signatures without proper ERC20 semantics, returning successful responses while implementing completely different logic.\n\n## Recommendation\n- Consider improving the natspec and documentation to properly outline the associated risks.\n- Maintain a list of verified tokens or framework to assess supported tokens offchain.\n\n## Aragon\nThe goal of this function is to catch basic accidental mistakes, rather than rejecting compliant yet malicious tokens. The choice of the token address is an arbitrary setting that the community either accepts or simply refrains from interacting with it. If a malicious ERC20 token was used for voting, then all of the assumptions on top would become pointless.\n\nWe acknowledge the potential risk of the deployer defining a malicious ERC20 token.\n\n## Spearbit\nAcknowledged.",
    "summary": "",
    "report_date": "2025-08-28T00:00:00.000Z",
    "contest_prize_txt": "",
    "contest_link": "https://github.com/spearbit/portfolio/blob/master/pdfs/Aragon-Spearbit-Security-Review-July-2025.pdf",
    "sponsor_name": null,
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://github.com/spearbit/portfolio/blob/master/pdfs/Aragon-Spearbit-Security-Review-July-2025.pdf",
    "github_link": "",
    "pdf_link": "https://solodit-bucket.s3.amazonaws.com/storage/reports/spearbit/Aragon-Spearbit-Security-Review-July-2025.pdf",
    "pdf_page_from": 22,
    "contest_id": "",
    "slug": "iscontract-and-_supportserc20-checks-can-produce-false-positives-spearbit-none-aragon-dao-gov-plugin-pdf",
    "firm_name": "Spearbit",
    "firm_logo_square": "spearbit_square.png",
    "protocol_name": "Aragon DAO Gov Plugin",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Om Parikh"
            }
        },
        {
            "wardens_warden": {
                "handle": "Emanuelle Ricci"
            }
        },
        {
            "wardens_warden": {
                "handle": "Patrick Drotleff"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Spearbit",
        "logo_square": "spearbit_square.png"
    },
    "protocols_protocol": {
        "name": "Aragon DAO Gov Plugin",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}