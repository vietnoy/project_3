{
    "id": 62567,
    "kind": "MARKDOWN",
    "auditfirm_id": 16,
    "impact": "LOW",
    "finders_count": 1,
    "protocol_id": 3420,
    "title": "[L-09] Inconsistent validation in `isValidListing()` and `isValidTrade()`",
    "content": "\n_Acknowledged_\n\nThe `isValidListing` function in the Marketplace contract performs **comprehensive checks to ensure that the NFT contract is whitelisted and that the requester is the actual owner of the NFT.** This proactive validation helps identify issues early and prevents errors to save gas costs.\n\n```solidity\n        if (!IWhitelistRegistry(whitelistRegistry).isWhitelisted(listing.request.tokenContractAddress)) {\n            revert NFTNotWhitelisted();\n        }\n        if (IERC721(listing.request.tokenContractAddress).ownerOf(listing.request.tokenId) != listing.request.owner) {\n            revert NotOwner();\n        }\n```\n\nIn contrast, the `isValidTrade` function only checks if the NFTs involved in the trade are whitelisted, neglecting to verify the ownership of the NFTs being traded. It is recommended to do the check earlier in order to save gas if the transaction is to be reverted.\n\n```solidity\n        // check if all the give NFTs and take NFTs are whitelisted\n        for (uint256 i = 0; i < trade.request.give.length; i++) {\n            if (!IWhitelistRegistry(whitelistRegistry).isWhitelisted(trade.request.give[i].tokenContractAddress)) {\n                revert NFTNotWhitelisted();\n            }\n        }\n\n        for (uint256 i = 0; i < trade.request.take.length; i++) {\n            if (!IWhitelistRegistry(whitelistRegistry).isWhitelisted(trade.request.take[i].tokenContractAddress)) {\n                revert NFTNotWhitelisted();\n            }\n        }\n\n```\n\nNote: the same issue exists in `isValidBid`.\n\n\n\n",
    "summary": "",
    "report_date": "2025-09-11T00:00:00.000Z",
    "contest_prize_txt": "",
    "contest_link": "",
    "sponsor_name": null,
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://github.com/pashov/audits/blob/master/team/md/RipIt-security-review_2025-04-25.md",
    "github_link": "",
    "pdf_link": "",
    "pdf_page_from": 0,
    "contest_id": "",
    "slug": "l-09-inconsistent-validation-in-isvalidlisting-and-isvalidtrade-pashov-audit-group-none-ripit_2025-04-25-markdown",
    "firm_name": "Pashov Audit Group",
    "firm_logo_square": "Pashov_square.png",
    "protocol_name": "RipIt_2025-04-25",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Pashov Audit Group"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Pashov Audit Group",
        "logo_square": "Pashov_square.png"
    },
    "protocols_protocol": {
        "name": "RipIt_2025-04-25",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}