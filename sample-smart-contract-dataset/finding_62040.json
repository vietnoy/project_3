{
    "id": 62040,
    "kind": "MARKDOWN",
    "auditfirm_id": 37,
    "impact": "MEDIUM",
    "finders_count": 4,
    "protocol_id": 3368,
    "title": "Signature Malleability in Unused `recoverSigner` Function",
    "content": "**Update**\nMarked as \"Fixed\" by the client. Addressed in: `b175349`. The client provided the following explanation:\n\n> fixed as part of [SAP-2](https://certificate.quantstamp.com/full/sapien/ffb7e698-6178-46f0-8df8-52e537af70c0/index.html#findings-qs2)\n\n![Image 46: Alert icon](https://certificate.quantstamp.com/full/sapien/ffb7e698-6178-46f0-8df8-52e537af70c0/static/media/success-icon-alert.4e26c8d3b65fdf9f4f0789a4086052ba.svg)\n\n**Update**\nMarked as \"Fixed\" by the client. Addressed in: `6c76d2a49d97a826d9eaec37673213672add9633`. The client provided the following explanation:\n\n> The vulnerability was fixed by removing the unused recoverSigner() function that relied on the vulnerable ecrecover precompile. Instead, the contract now uses OpenZeppelin's ECDSA library for signature verification.\n\n![Image 47: Alert icon](https://certificate.quantstamp.com/full/sapien/ffb7e698-6178-46f0-8df8-52e537af70c0/static/media/success-icon-alert.4e26c8d3b65fdf9f4f0789a4086052ba.svg)\n\n**Update**\nMarked as \"Fixed\" by the client. Addressed in: `6c76d2a49d97a826d9eaec37673213672add9633`. The client provided the following explanation:\n\n> The vulnerability was fixed by removing the unused recoverSigner() function that relied on the vulnerable ecrecover precompile. Instead, the contract now uses OpenZeppelin's ECDSA library for signature verification.\n\n**File(s) affected:**`Rewards.sol`\n\n**Description:** The `recoverSigner()` function in the `Rewards` contract uses the `ecrecover` precompile which is vulnerable to signature malleability. This vulnerability allows multiple valid signatures to be generated for the same message, as ecrecover accepts signatures with both high and low values of the s parameter.\n\nWhile this would typically be a high-severity issue that could allow signature replay attacks, the severity is significantly reduced because the function is currently unused in the contract. But since the contract is upgradeable consider fixing this issue to avoid impacting newer versions.\n\n**Recommendation:** Avoid using this function and instead ensure the OpenZeppelin `ECDSA` library is used, which makes the necessary checks to ensure signature malleability is not possible.",
    "summary": "\nA bug was reported in the `Rewards.sol` file of the `Sapien` project. The `recoverSigner()` function in the contract uses a vulnerable precompile called `ecrecover` which allows for multiple valid signatures to be generated for the same message. This could potentially lead to signature replay attacks. The client has fixed this issue by removing the function and using the OpenZeppelin `ECDSA` library instead. This ensures that signature malleability is not possible. ",
    "report_date": "2025-03-30T00:00:00.000Z",
    "contest_prize_txt": "",
    "contest_link": "https://certificate.quantstamp.com/full/sapien/ffb7e698-6178-46f0-8df8-52e537af70c0/index.html",
    "sponsor_name": "",
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://certificate.quantstamp.com/full/sapien/ffb7e698-6178-46f0-8df8-52e537af70c0/index.html",
    "github_link": "",
    "pdf_link": "",
    "pdf_page_from": 0,
    "contest_id": "",
    "slug": "signature-malleability-in-unused-recoversigner-function-quantstamp-sapien-markdown",
    "firm_name": "Quantstamp",
    "firm_logo_square": "quantstamp_square.png",
    "protocol_name": "Sapien",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Paul Clemson"
            }
        },
        {
            "wardens_warden": {
                "handle": "Julio Aguilar"
            }
        },
        {
            "wardens_warden": {
                "handle": "Mostafa Yassin"
            }
        },
        {
            "wardens_warden": {
                "handle": "Tim Sigl"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Quantstamp",
        "logo_square": "quantstamp_square.png"
    },
    "protocols_protocol": {
        "name": "Sapien",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}