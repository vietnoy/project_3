{
    "id": 62782,
    "kind": "MARKDOWN",
    "auditfirm_id": 37,
    "impact": "LOW",
    "finders_count": 3,
    "protocol_id": 3426,
    "title": "Owner Can Cause Denial of Service by Setting Rewardsduration to Zero",
    "content": "**Update**\nMarked as \"Acknowledged\" by the client. The client provided the following explanation:\n\n> owner will be a multisig and is trusted\n\n**File(s) affected:**`src/CampStakingVault.sol`\n\n**Description:** The owner-only function `setRewardsDuration()` allows setting a new duration for reward periods. However, it lacks a check to prevent `_rewardsDuration` from being set to zero. If the owner calls this function with `_rewardsDuration = 0`, the rewardsDuration state variable becomes zero. The next time the owner attempts to start a new reward period by calling `notifyRewardAmount()`, the transaction will revert due to a division-by-zero error in the line `rewardRate = reward / rewardsDuration`. This bricks the reward distribution mechanism, making it impossible to add new rewards until the owner rectifies the situation by calling `setRewardsDuration()` again with a non-zero value.\n\n```\nfunction setRewardsDuration(uint256 _rewardsDuration) external onlyOwner {\n    if (block.timestamp <= periodFinish) revert RewardsPeriodNotFinished();\n    rewardsDuration = _rewardsDuration;\n    emit RewardsDurationUpdated(rewardsDuration);\n}\n```\n\n**Exploit Scenario:**\n\n1.   Owner calls `setRewardsDuration()` with `_rewardsDuration = 0`.\n2.   The rewardsDuration state variable is set to zero.\n3.   Owner attempts to start a new reward period by calling `notifyRewardAmount()`.\n4.   The transaction reverts due to division-by-zero error when calculating `rewardRate = reward / rewardsDuration`.\n5.   The reward distribution mechanism is bricked until the owner calls `setRewardsDuration()` again with a non-zero value.\n\n**Recommendation:** Add a require statement to the setRewardsDuration() function to ensure the new duration is a positive value.\n\n```\nfunction setRewardsDuration(uint256 _rewardsDuration) external onlyOwner {\n    if (block.timestamp <= periodFinish) revert RewardsPeriodNotFinished();\n    require(_rewardsDuration > 0, \"Rewards duration must be greater than zero\");\n    rewardsDuration = _rewardsDuration;\n    emit RewardsDurationUpdated(rewardsDuration);\n}\n```",
    "summary": "",
    "report_date": "2025-09-15T14:22:57.388Z",
    "contest_prize_txt": "",
    "contest_link": "https://certificate.quantstamp.com/full/camp/ae830654-5f2b-4d21-aba2-1de572092da6/index.html",
    "sponsor_name": "",
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://certificate.quantstamp.com/full/camp/ae830654-5f2b-4d21-aba2-1de572092da6/index.html",
    "github_link": "",
    "pdf_link": "",
    "pdf_page_from": 0,
    "contest_id": "",
    "slug": "owner-can-cause-denial-of-service-by-setting-rewardsduration-to-zero-quantstamp-camp-markdown",
    "firm_name": "Quantstamp",
    "firm_logo_square": "quantstamp_square.png",
    "protocol_name": "Camp",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Paul Clemson"
            }
        },
        {
            "wardens_warden": {
                "handle": "Gereon Mendler"
            }
        },
        {
            "wardens_warden": {
                "handle": "Andy Lin"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Quantstamp",
        "logo_square": "quantstamp_square.png"
    },
    "protocols_protocol": {
        "name": "Camp",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}