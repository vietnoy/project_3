{
    "id": 62868,
    "kind": "PDF",
    "auditfirm_id": 9,
    "impact": "HIGH",
    "finders_count": 1,
    "protocol_id": 3450,
    "title": "Missing debt validation in group burn function",
    "content": "## Denial of Service: _burnGroupBalances Function\n\n**Diﬃculty:** Medium  \n**Type:** Denial of Service  \n\n## Description\nThe `_burnGroupBalances` function fails to validate that the burn operation completes successfully when expired tokens are present, potentially creating inconsistencies between ERC1155 balance tracking and group array tracking. The function skips over expired token groups during burning but does not verify that the burn was completed successfully.\n\nThe `_burnGroupBalances` function iterates through the account’s token groups in FIFO order to burn the requested amount. However, it skips over expired token groups without accounting for them in the burn calculation. When the loop completes, there is no verification that the debt variable has reached zero, meaning that the burn may be incomplete.\n\n```solidity\nfunction _burnGroupBalances(address account, uint256 id, uint256 amount) internal {\n    Group[] storage groups = _group[account][id];\n    uint256 _now = block.timestamp;\n    uint256 debt = amount;\n    uint256 i = 0;\n    while (i < groups.length && debt > 0) {\n        if (groups[i].expiresAt <= _now) {\n            i++;\n            continue;\n        }\n        if (groups[i].balance > debt) {\n            // Burn partial token group\n            groups[i].balance -= debt;\n            debt = 0;\n        } else {\n            // Burn entire token group\n            debt -= groups[i].balance;\n            groups[i].balance = 0;\n        }\n        i++;\n    }\n}\n```\n\n*Figure 4.1: Missing debt validation in the `_burnGroupBalances` function*\n\n## Exploit Scenario\nAlice has five authentication tokens distributed across two groups:\n- **Group A:** Three tokens (expires at t=100, current time t=50)\n- **Group B:** Two tokens (expires at t=200, current time t=50)\n\nTime advances to t=150, making Group A expired. The token burner attempts to burn four of Alice’s tokens. The ERC1155 balance tracking correctly updates to show that Alice has one token remaining. However, the group burn processes only two non-expired tokens from Group B, leaving the burn incomplete. The group arrays now contain inconsistent data, where Alice’s group array shows fewer tokens than her ERC1155 balance.\n\n## Recommendations\n- **Short term:** Add a check at the end of the `_burnGroupBalances` function to verify that debt equals zero, ensuring the burn was completed successfully.\n- **Long term:** Implement comprehensive unit tests that cover burn scenarios with mixed valid and expired tokens, and consider redesigning the burn logic to properly account for expired tokens during the burn process.",
    "summary": "\nThe `_burnGroupBalances` function in the code has a bug that can cause a denial of service. This means that it can prevent users from accessing their tokens. The function does not check if the burning process was successful when dealing with expired tokens. This can result in incorrect tracking of token balances and group data. An attacker can exploit this by having a mix of valid and expired tokens and attempting to burn them. The recommended solution is to add a check at the end of the function to ensure the burn was completed successfully. In the long term, comprehensive tests should be implemented and the burn logic should be redesigned to properly account for expired tokens.",
    "report_date": "2025-10-03T00:00:00.000Z",
    "contest_prize_txt": "",
    "contest_link": "https://github.com/trailofbits/publications/blob/master/reviews/2025-10-radiustechnology-evmauth-securityreview.pdf",
    "sponsor_name": null,
    "sponsor_link": "",
    "quality_score": 5,
    "general_score": 5,
    "source_link": "https://github.com/trailofbits/publications/blob/master/reviews/2025-10-radiustechnology-evmauth-securityreview.pdf",
    "github_link": "",
    "pdf_link": "https://solodit-bucket.s3.amazonaws.com/storage/reports/trailofbits/2025-10-radiustechnology-evmauth-securityreview.pdf",
    "pdf_page_from": 19,
    "contest_id": "",
    "slug": "missing-debt-validation-in-group-burn-function-trailofbits-none-radius-technology-evmauth-pdf",
    "firm_name": "TrailOfBits",
    "firm_logo_square": "trailofbits_square.png",
    "protocol_name": "Radius Technology EVMAuth",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Quan Nguyen Trail of Bits PUBLIC"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "TrailOfBits",
        "logo_square": "trailofbits_square.png"
    },
    "protocols_protocol": {
        "name": "Radius Technology EVMAuth",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}