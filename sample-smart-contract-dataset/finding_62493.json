{
    "id": 62493,
    "kind": "GIT",
    "auditfirm_id": 3,
    "impact": "MEDIUM",
    "finders_count": 4,
    "protocol_id": 3104,
    "title": "M-1: Hard-Coded Mainnet WETH Address Breaks All Non-Mainnet Deployments",
    "content": "\nSource: https://github.com/sherlock-audit/2025-06-notional-exponent-judging/issues/195 \n\n## Found by \n0xShoonya, boredpukar, talfao, vangrim\n\n## Summary\nThe protocol’s core contracts (strategies, routers, and withdraw-request managers) all reference a single compile-time constant:\n\n```solidity\nWETH9 constant WETH = WETH9(0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2);\n```\n\nThis is the Ethereum-mainnet WETH9. When the same bytecode is deployed to chains like Arbitrum, Base, or any L2/sidechain whose wrapped-ETH token lives at a different address, every call to `WETH.withdraw()` or `WETH.deposit{value:...}()` will either revert or no-op. \n\n## Vulnerability Description\n\n[https://github.com/sherlock-audit/2025-06-notional-exponent/blob/82c87105f6b32bb362d7523356f235b5b07509f9/notional-v4/src/utils/Constants.sol#L19](https://github.com/sherlock-audit/2025-06-notional-exponent/blob/82c87105f6b32bb362d7523356f235b5b07509f9/notional-v4/src/utils/Constants.sol#L19)\n\nThroughout the codebase—e.g. in `AbstractStakingStrategy`, `CurveConvexLib`, `EtherFiWithdrawRequestManager`, and others—`WETH` is declared as a constant pointing at mainnet’s `0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2` address.\n\n> Ethereum, in the future we will consider Base or Arbitrum\n\nOn chains where that address has no code or contains an unrelated contract:\n\n`withdraw()` reverts → funds are stranded inside withdraw-managers (EtherFi, Dinero, Origin, etc.) and strategies during exits.\n\n`deposit{value: …}()` emits no ERC-20, so accounting under-flows on the very next balanceOf / health-factor check, blocking redemptions and liquidations protocol-wide.\n\nBecause the constant is declared at compile-time, recompiling once and re-using the same artefacts for multiple chains is enough to brick the deployment.\n\n## Impact\nMedium - Protocol may not work on most of the supported blockchains.\n\n## Likelihood\nMedium - The architecture explicitly targets future deployments on Arbitrum, Base, etc.\n\n## Severity\nMedium\n\n## Recommendations\nMake `WETH` an immutable constructor argument or pull it from `AddressRegistry`.\n\nAt deployment, assert `address(WETH).code.length > 0`.\n\n\n\n\n\n",
    "summary": "\nThis bug report discusses a vulnerability in a protocol's core contracts (strategies, routers, and withdraw-request managers). The issue is that these contracts all reference a single compile-time constant, which points to the Ethereum-mainnet WETH9. However, on other chains like Arbitrum or Base, this address may not exist or may contain an unrelated contract. This can cause issues with the protocol's functionality, such as stranded funds and blocked redemptions and liquidations. The impact of this bug is considered medium, as it may affect the protocol's functionality on most supported blockchains. The likelihood and severity are also classified as medium. The report recommends making WETH an immutable constructor argument or pulling it from an AddressRegistry to prevent this issue.",
    "report_date": "2025-07-18T15:00:00.000Z",
    "contest_prize_txt": "75500 USDC",
    "contest_link": "https://app.sherlock.xyz/audits/contests/1001",
    "sponsor_name": "",
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "",
    "github_link": "https://github.com/sherlock-audit/2025-06-notional-exponent-judging/issues/195",
    "pdf_link": "",
    "pdf_page_from": 0,
    "contest_id": "1001",
    "slug": "m-1-hard-coded-mainnet-weth-address-breaks-all-non-mainnet-deployments-sherlock-notional-exponent-git",
    "firm_name": "Sherlock",
    "firm_logo_square": "sherlock_square.png",
    "protocol_name": "Notional Exponent",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "talfao"
            }
        },
        {
            "wardens_warden": {
                "handle": "0xShoonya"
            }
        },
        {
            "wardens_warden": {
                "handle": "vangrim"
            }
        },
        {
            "wardens_warden": {
                "handle": "boredpukar"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Sherlock",
        "logo_square": "sherlock_square.png"
    },
    "protocols_protocol": {
        "name": "Notional Exponent",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}