{
    "id": 62278,
    "kind": "PDF",
    "auditfirm_id": 6,
    "impact": "HIGH",
    "finders_count": 3,
    "protocol_id": 3396,
    "title": "In updateAToken and updateVariableDebtToken of the LendingPoolConfigurator encodedCallis con-",
    "content": "## Vulnerability Report\n\n## Severity\n**High Risk**\n\n## Context\n- `LendingPoolConfigurator.sol#L173-L183`\n- `LendingPoolConfigurator.sol#L206-L215`\n\n## Description\nIn `updateAToken` and `updateVariableDebtToken` of the `LendingPoolConfigurator`, `encodedCall` is constructed incorrectly:\n\n```solidity\nbytes memory encodedCall = abi.encodeWithSelector(\n    /*...*/ selector,\n    cachedPool,\n    // ...\n    input.asset,\n    input.incentivesController,\n    decimals, // <--- `reserveType` is missing after here\n    input.name,\n    input.symbol,\n    input.params\n);\n```\n\nAs a result, `RESERVE_TYPE`, `name`, `symbol`, and `params` will be set incorrectly in the proxy contracts. This will cause all subsequent calls to query or update data for an incorrect reserve in the lending pool:\n\n```solidity\npool.function(_underlyingAsset, RESERVE_TYPE, /*...*/ )\n```\n\n## Recommendation\nAdd the missing `reserveType` parameter and also ensure that instead of using `abi.encodeWithSelector`, `abi.encodeCall` is used to avoid potential future mistakes regarding typos and incorrect parameter types.\n\n## Audit Reports\n- **Astera:** Fixed in commit 8bc4648c.\n- **Spearbit:** Fix verified.",
    "summary": "\nThis bug report is about a high-risk vulnerability found in the `LendingPoolConfigurator` contract. The vulnerability is located in the `updateAToken` and `updateVariableDebtToken` functions, specifically in the construction of the `encodedCall` variable. This variable is used to update certain parameters in the proxy contracts, but it is missing the `reserveType` parameter. This results in incorrect data being set for `RESERVE_TYPE`, `name`, `symbol`, and `params` in the proxy contracts, which can cause incorrect data to be queried or updated in the lending pool. The recommendation is to add the missing `reserveType` parameter and use `abi.encodeCall` instead of `abi.encodeWithSelector` to avoid potential future mistakes. The bug has been fixed by Astera and verified by Spearbit.",
    "report_date": "2025-08-29T00:00:00.000Z",
    "contest_prize_txt": "",
    "contest_link": "https://github.com/spearbit/portfolio/blob/master/pdfs/Astera-Spearbit-Security-Review-December-2024.pdf",
    "sponsor_name": null,
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://github.com/spearbit/portfolio/blob/master/pdfs/Astera-Spearbit-Security-Review-December-2024.pdf",
    "github_link": "",
    "pdf_link": "https://solodit-bucket.s3.amazonaws.com/storage/reports/spearbit/Astera-Spearbit-Security-Review-December-2024.pdf",
    "pdf_page_from": 12,
    "contest_id": "",
    "slug": "in-updateatoken-and-updatevariabledebttoken-of-the-lendingpoolconfigurator-encodedcallis-con-spearbit-none-astera-pdf",
    "firm_name": "Spearbit",
    "firm_logo_square": "spearbit_square.png",
    "protocol_name": "Astera",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Saw-mon and Natalie"
            }
        },
        {
            "wardens_warden": {
                "handle": "Cergyk"
            }
        },
        {
            "wardens_warden": {
                "handle": "Jonatas Martins"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Spearbit",
        "logo_square": "spearbit_square.png"
    },
    "protocols_protocol": {
        "name": "Astera",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}