{
    "id": 62779,
    "kind": "MARKDOWN",
    "auditfirm_id": 37,
    "impact": "MEDIUM",
    "finders_count": 3,
    "protocol_id": 3426,
    "title": "Small Deposits Can Increase Cost of `batchRelease()` Function",
    "content": "**Update**\nMarked as \"Fixed\" by the client. Addressed in: `f51d133`.\n\n**File(s) affected:**`CampTimelockEscrowNativeOFT.sol`\n\n**Description:** This escrow bridge relies on a queue to manage deposits. All new deposits are appended to the queue and share the same `holdPeriod` before the bridging operation can commence. The queue is checked and consumed using the `batchRelease()` function, which increments a global cursor indicating the cutoff index of processed deposits in the queue. For each batch, some supplied maximum amount of entries is checked, bridging deposits where the `unlockTimestamp` has passed.\n\nNo deposits in the queue can be skipped, and the `bridgeOut()` function is likely substantially cheaper in gas than the `send()` function and does not enforce a minimum deposit. Therefore, small deposits could be use to extend the size of the queue substantially, requiring someone to pay the gas cost of initiating all those bridging transactions using the `batchRelease()` function before any deposits later in the queue can be executed.\n\n**Exploit Scenario:**\n\n1.   Mallory makes multiple small deposits using the `bridgeOut()` function. \n2.   Alice makes a deposit. \n3.   After the unlock period, the gas for all of Mallorys transactions needs to be payed before Alice' deposit can be executed.\n\n**Recommendation:** Add a minimum deposit amount to make the cost associated with this attack infeasible. Alternatively, expose a function that releases the deposit of a specific queue index.",
    "summary": "\nThis bug report is about an issue with an escrow bridge that is used to manage deposits. The problem is that small deposits can be used to clog up the queue, making it more expensive for larger deposits to be processed. This could be used by someone to cause delays and increase the gas cost for others. The recommendation is to add a minimum deposit amount or create a function that can release a specific deposit in the queue to prevent this kind of attack.",
    "report_date": "2025-09-15T14:22:57.388Z",
    "contest_prize_txt": "",
    "contest_link": "https://certificate.quantstamp.com/full/camp/ae830654-5f2b-4d21-aba2-1de572092da6/index.html",
    "sponsor_name": "",
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://certificate.quantstamp.com/full/camp/ae830654-5f2b-4d21-aba2-1de572092da6/index.html",
    "github_link": "",
    "pdf_link": "",
    "pdf_page_from": 0,
    "contest_id": "",
    "slug": "small-deposits-can-increase-cost-of-batchrelease-function-quantstamp-camp-markdown",
    "firm_name": "Quantstamp",
    "firm_logo_square": "quantstamp_square.png",
    "protocol_name": "Camp",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Paul Clemson"
            }
        },
        {
            "wardens_warden": {
                "handle": "Gereon Mendler"
            }
        },
        {
            "wardens_warden": {
                "handle": "Andy Lin"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Quantstamp",
        "logo_square": "quantstamp_square.png"
    },
    "protocols_protocol": {
        "name": "Camp",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}