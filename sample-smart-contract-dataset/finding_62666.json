{
    "id": 62666,
    "kind": "MARKDOWN",
    "auditfirm_id": 23,
    "impact": "MEDIUM",
    "finders_count": 1,
    "protocol_id": 3435,
    "title": "Unclaimed LP Tokens in Zap Contract",
    "content": "##### Description\nThis issue has been identified within the `zapOut` function of the `Zap` contract. \n\nWhen the `proportional` parameter is set to `false`, LP tokens may remain on the contract after the operation completes. An attacker could exploit this by passing custom SPA and WLP addresses to steal these tokens or by leveraging excessive approvals within the contract. This vulnerability arises because the function does not return residual LP tokens to the user or validate the provided SPA and WLP addresses. \n\nThe issue is classified as **medium** severity because it could lead to loss of funds under specific conditions, though exploitation requires deliberate manipulation by an attacker.\n##### Recommendation\nWe recommend modifying the `zapOut` function to return any remaining LP tokens to the user after the operation.",
    "summary": "The `zapOut` function in the `Zap` contract has a bug that could result in loss of funds if exploited by an attacker. This happens when the `proportional` parameter is set to `false`, causing LP tokens to remain on the contract after the operation is completed. The attacker could then use custom addresses to steal these tokens or take advantage of excessive approvals within the contract. To fix this, the `zapOut` function should be modified to return any remaining LP tokens to the user. This issue is classified as medium severity and requires deliberate manipulation by an attacker to be exploited.",
    "report_date": "2025-09-19T00:00:00.000Z",
    "contest_prize_txt": "",
    "contest_link": "",
    "sponsor_name": null,
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://github.com/mixbytes/audits_public/blob/master/NUTS%20Finance/Tapio/README.md#3-unclaimed-lp-tokens-in-zap-contract",
    "github_link": "",
    "pdf_link": "",
    "pdf_page_from": 0,
    "contest_id": "",
    "slug": "unclaimed-lp-tokens-in-zap-contract-mixbytes-none-nuts-finance-markdown",
    "firm_name": "MixBytes",
    "firm_logo_square": "mixbytes_square.png",
    "protocol_name": "NUTS Finance",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "MixBytes"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "MixBytes",
        "logo_square": "mixbytes_square.png"
    },
    "protocols_protocol": {
        "name": "NUTS Finance",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}