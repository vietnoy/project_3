{
    "id": 62193,
    "kind": "MARKDOWN",
    "auditfirm_id": 30,
    "impact": "MEDIUM",
    "finders_count": 1,
    "protocol_id": 3390,
    "title": "[M-02] Executor Can Deliver Cross-Chain Messages with Unvalidated Native Value",
    "content": "\n## Severity\n\nMedium Risk\n\n## Description\n\nThe `AbstractBridge` contract contains a vulnerability in its `_lzReceive()` function, where it fails to validate the `msg.value` parameter against the intended native value that should accompany cross-chain message execution. This vulnerability stems from LayerZero's execution model, where any party can execute verified messages, and the receiving contract cannot guarantee that the execution parameters match those originally specified in the executor options.\n\nThe vulnerability manifests in the `_lzReceive()` function within `AbstractBridge.sol`, which processes incoming cross-chain messages without implementing native value validation. The current message decoding logic `abi.decode(_message, (address, uint256[]))` only extracts the recipient address and token IDs, completely omitting any validation of the native value that should accompany the message execution.\n\nWhen users initiate bridging operations through the ETHBridge contract's `bridgeRingToAbstract()` function, they specify executor options that may include native value requirements for destination chain execution. However, the `AbstractBridge` contract operates under the assumption that the `msg.value` received during `_lzReceive()` execution matches the originally intended amount.\n\nReference - [enforce-msgvalue-in-\\_lzreceive-and-lzcompose](https://docs.layerzero.network/v2/developers/evm/technical-reference/integration-checklist#enforce-msgvalue-in-_lzreceive-and-lzcompose)\n\n## Location of Affected Code\n\nFile: [contracts/AbstractBridge.sol#L39](https://github.com/onchain-heroes/och-bridge-contracts/blob/6b6bb6bcbf718649fe9ea3539414149f2a6d28aa/contracts/AbstractBridge.sol#L39)\n\n```solidity\nfunction _lzReceive(Origin calldata, bytes32, bytes calldata _message, address, bytes calldata) internal override {\n    // code\n    (address recipient, uint256[] memory tokenIds) = abi.decode(_message, (address, uint256[]));\n\n    uint256 len = tokenIds.length;\n    for (uint256 i = 0; i < len; ++i) {\n        // Transfer the ring to this contract\n        OCH_RING_CONTRACT.transferFrom(address(this), recipient, tokenIds[i]);\n    }\n}\n```\n\n## Impact\n\nWhile the current Genesis Ring bridge implementation does not explicitly utilize msg.value in its processing logic but it is best practice to check `msg.value`.\n\n## Recommendation\n\nTo address this vulnerability, the bridge contracts must implement comprehensive validation of native value parameters by encoding intended execution values in cross-chain messages and validating them during destination execution.\n\n## Team Response\n\nAcknowledged.\n\n",
    "summary": "\nThe AbstractBridge contract has a medium risk vulnerability in its _lzReceive() function. This function fails to validate the msg.value parameter against the intended native value for cross-chain message execution. This means that the receiving contract cannot guarantee that the execution parameters match those originally specified. The vulnerability is located in the AbstractBridge.sol file at line 39. To fix this, the bridge contracts should implement validation of native value parameters by encoding them in cross-chain messages and validating them during destination execution. The team has acknowledged this issue.",
    "report_date": "2025-08-27T00:00:00.000Z",
    "contest_prize_txt": "",
    "contest_link": "",
    "sponsor_name": null,
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://github.com/shieldify-security/audits-portfolio-md/blob/main/OnchainHeroes-GenesisBridge-Security-Review.md",
    "github_link": "",
    "pdf_link": "",
    "pdf_page_from": 0,
    "contest_id": "",
    "slug": "m-02-executor-can-deliver-cross-chain-messages-with-unvalidated-native-value-shieldify-none-onchainheroes-genesisbridge-markdown",
    "firm_name": "Shieldify",
    "firm_logo_square": "Shieldify_square.png",
    "protocol_name": "Onchainheroes Genesisbridge",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Shieldify Security"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Shieldify",
        "logo_square": "Shieldify_square.png"
    },
    "protocols_protocol": {
        "name": "Onchainheroes Genesisbridge",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}