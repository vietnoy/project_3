{
    "id": 62863,
    "kind": "MARKDOWN",
    "auditfirm_id": 30,
    "impact": "LOW",
    "finders_count": 1,
    "protocol_id": 3449,
    "title": "[L-07] Not Checking for Sequencer Down for L2 Networks like Arbitrum",
    "content": "\n## Severity\n\nLow Risk\n\n## Description\n\nThe Current system is designed to work in different chains, and A lot of L2 networks are supported, including Arbitrum.\n\nIn Arbitrum L2, there is a sequencer that manages transaction ordering, execution, etc... But this sequencer can become unavailable. When it goes to work again, it handles all queued transactions before and submits them at once, which affects protocols that rely on Token Prices, the liquidation process, etc...\n\nRef: https://docs.chain.link/data-feeds/l2-sequencer-feeds\n\nOur Price check is not adding the sequencer check, it only relies on Data Feeds. So in case the sequencer goes down and comes back to work, there can be a mistake in the calculations of the Prices, or some users take advantage over the others.\n\n## Location of Affected Code\n\nFile: [GasTankPaymaster.sol#L388-L405](https://github.com/etherspot/etherspot-modular-accounts/blob/9019f2a78c36e74bdb1df4029672998cb4631162/src/paymaster/GasTankPaymaster.sol#L388-L405)\n\n```solidity\nfunction updateCachedPrice(bool force) public returns (uint256) {\n    GasTankPaymasterConfig storage gtpConfig = paymasterConfig;\n    uint256 cacheAge = block.timestamp - gtpConfig.cachedPriceTimestamp;\n    if (!force && cacheAge <= gtpConfig.nativeMaxAge && gtpConfig.cachedTokenPrice > 0) {\n        return gtpConfig.cachedTokenPrice;\n    }\n    // Try to get and validate prices\n    (bool success, uint256 newPrice) = _tryGetFreshPrice(gtpConfig);\n    if (success) {\n        gtpConfig.cachedTokenPrice = newPrice;\n        gtpConfig.cachedPriceTimestamp = uint48(block.timestamp);\n        emit GasTankPaymaster_TokenPriceUpdated(newPrice, 0, gtpConfig.cachedPriceTimestamp);\n        return newPrice;\n    } else {\n        emit GasTankPaymaster_OracleUpdateFailed();\n        return 0; // Signal failure\n    }\n}\n```\n\n## Impact\n\nIncorrect calculations in case the sequencer goes down\n\n## Recommendation\n\nWe can use the Sequencer feed, which will be an optional and we will add it only to the L2 that is supported to have Sequencer feed by ChainLink. And if it exists, we check for it.\n\nNOTE: Adding the sequencer should be made with `GRACE_PERIOD`, in case it goes down and then is worked on again. More information on how to add it can be found [here](https://docs.chain.link/data-feeds/l2-sequencer-feeds).\n\n## Team Response\n\nFixed.\n\n",
    "summary": "",
    "report_date": "2025-10-03T00:00:00.000Z",
    "contest_prize_txt": "",
    "contest_link": "",
    "sponsor_name": null,
    "sponsor_link": "",
    "quality_score": 0,
    "general_score": 0,
    "source_link": "https://github.com/shieldify-security/audits-portfolio-md/blob/main/Etherspot-GasTankPaymasterModule-Extended-Security-Review.md",
    "github_link": "",
    "pdf_link": "",
    "pdf_page_from": 0,
    "contest_id": "",
    "slug": "l-07-not-checking-for-sequencer-down-for-l2-networks-like-arbitrum-shieldify-none-etherspot-gastankpaymastermodule-extended-markdown",
    "firm_name": "Shieldify",
    "firm_logo_square": "Shieldify_square.png",
    "protocol_name": "Etherspot Gastankpaymastermodule Extended",
    "bookmarked": false,
    "read": false,
    "issues_issue_finders": [
        {
            "wardens_warden": {
                "handle": "Shieldify Security"
            }
        }
    ],
    "auditfirms_auditfirm": {
        "name": "Shieldify",
        "logo_square": "Shieldify_square.png"
    },
    "protocols_protocol": {
        "name": "Etherspot Gastankpaymastermodule Extended",
        "protocols_protocolcategoryscore": []
    },
    "issues_issuetagscore": []
}